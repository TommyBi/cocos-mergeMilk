window.__require=function t(e,o,n){function r(a,c){if(!o[a]){if(!e[a]){var u=a.split("/");if(u=u[u.length-1],!e[u]){var l="function"==typeof __require&&__require;if(!c&&l)return l(u,!0);if(i)return i(u,!0);throw new Error("Cannot find module '"+a+"'")}a=u}var s=o[a]={exports:{}};e[a][0].call(s.exports,function(t){return r(e[a][1][t]||t)},s,s.exports,t,e,o,n)}return o[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<n.length;a++)r(n[a]);return r}({AudioMgr:[function(t,e,o){"use strict";cc._RF.push(e,"b545bFTIb1JV5LuLuiz55fk","AudioMgr"),Object.defineProperty(o,"__esModule",{value:!0}),o.audioMgr=o.SoundType=o.MusicType=void 0,o.MusicType||(o.MusicType={}),function(t){t.MOVE_COIN="moveCoin",t.PRODUCE_COIN="produceCoin",t.MERGE_COIN="mergeCoin",t.ERROR="error"}(o.SoundType||(o.SoundType={}));var n=function(){function t(){this.soundClipCache={},this.audioIds={},this.musicVolume=null,this.soundVolume=null,this.curBgMusic=null,this.canPlayMusic=!0,this.canPlaySound=!0,this.musicId=-1}return t.prototype.init=function(){cc.log("audioMgr init"),this.curBgMusic=null,this.musicVolume=.2,this.soundVolume=1,this.canPlayMusic=!0,this.canPlaySound=!0},t.prototype.playBGM=function(t){this.curBgMusic&&this.curBgMusic==t||(this.curBgMusic=t,this.canPlayMusic&&(this.stopBGM(),cc.resources.load(t,function(e,o){this.curBGMUrl==t?(cc.audioEngine.stopAll(),this.bgmAudioID=cc.audioEngine.play(o,!0,this.bgmVolume)):console.log("\u64ad\u653e\u80cc\u666f\u97f3\u4e50\u5931\u8d25:",e)}.bind(this))))},t.prototype.stopBGM=function(){cc.audioEngine.stop(this.musicId)},t.prototype.playSound=function(t,e,o,n,r,i){var a=this;if(void 0===e&&(e=this.soundVolume),void 0===o&&(o=".mp3"),void 0===n&&(n=!1),void 0===r&&(r=!1),this.canPlaySound){var c="sounds/"+t;if(this.soundClipCache[""+c])cc.audioEngine.play(this.soundClipCache[""+c],n,e),i&&i();else if(r){if(!c.startsWith("https://"))return void(i&&i());cc.assetManager.loadRemote(c,{ext:o},function(t,o){if(t)console.error(t);else{var r=cc.audioEngine.play(o,n,e);a.audioIds[c]=r}i&&i()})}else cc.resources.load(c,function(t,o){if(t)console.error(t);else{var r=cc.audioEngine.play(o,n,e);a.soundClipCache[""+c]=o,a.audioIds[c]=r}i&&i()})}else i&&i()},t.prototype.stopSoundByUrl=function(t){var e=this.audioIds[t];null!=e&&cc.audioEngine.stop(e)},t.prototype.stopSound=function(t){console.log("audioId",t),null!=t&&cc.audioEngine.stop(t)},t.prototype.pauseBGM=function(){this.musicId>=0&&cc.audioEngine.pause(this.musicId)},t.prototype.resumeBGM=function(){this.musicId>=0&&cc.audioEngine.resume(this.musicId)},t.prototype.uncache=function(t){var e=cc.url.raw(t);cc.audioEngine.uncache(e),this.soundClipCache[""+t]=void 0},t.prototype.uncacheAll=function(){cc.audioEngine.uncacheAll(),this.soundClipCache={}},t.prototype.pauseAll=function(){console.log("Pause All Sound"),cc.audioEngine.pauseAll()},t.prototype.resumeAll=function(){console.log("Resum All Sound"),cc.audioEngine.resumeAll()},t.prototype.stopAll=function(){cc.audioEngine.stopAll()},t.prototype.clean=function(){this.stopAll(),this.uncacheAll(),this.curBgMusic="",this.musicId=-1},t.Instance=new t,t}();o.default=n,o.audioMgr=n.Instance,cc._RF.pop()},{}],Coin:[function(t,e,o){"use strict";cc._RF.push(e,"6cba59FrPtA0YaVzatN4FVJ","Coin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,c=a.ccclass,u=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ulblNum=null,e.uImgBg=null,e}return r(e,t),e.prototype.onLoad=function(){this.ulblNum.string="-"},e.prototype.init=function(t,e,o){var n=this,r="images/coin/"+e;cc.resources.load(r,cc.SpriteFrame,function(t,e){t?console.error("url:",r,"/err:"):(n.uImgBg.spriteFrame=e,o&&o())}),this.ulblNum.string=""+e},e.prototype.start=function(){},i([u(cc.Label)],e.prototype,"ulblNum",void 0),i([u(cc.Sprite)],e.prototype,"uImgBg",void 0),i([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],DataModule:[function(t,e,o){"use strict";cc._RF.push(e,"a9783XxZiJAGobx47+4NsqL","DataModule"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.mData=null}return t.prototype.parseData=function(t){this.mData=t},t}();o.default=n,cc._RF.pop()},{}],Define:[function(t,e,o){"use strict";cc._RF.push(e,"b316ef97uJJrLtjj1+6n+lc","Define"),Object.defineProperty(o,"__esModule",{value:!0}),o.EventType=void 0,function(t){t.MOVE_COIN="move_coin",t.MOVE_END="move_end",t.CHECK_MERGE="check_merge",t.MERGE_COIN="merge_coin",t.MERGE_END="merge_end",t.MOVE_CHECK_FAIL="move_check_fail",t.CANCEL_SELECT="CANCEL_SELECT"}(o.EventType||(o.EventType={})),cc._RF.pop()},{}],EventManager:[function(t,e,o){"use strict";cc._RF.push(e,"ea7fbBwaBVK96i8sl/y0ydr","EventManager");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.eventManager=o.GameEvent=o.EventManager=void 0;var i=function(t){function e(){return t.call(this)||this}return r(e,t),e.prototype.dispatch=function(t,e){this.dispatchEvent(new a(t,e))},e.Instance=new e,e}(cc.EventTarget);o.EventManager=i;var a=function(t){function e(e,o){void 0===o&&(o=null);var n=t.call(this,e,!0)||this;return n.data=null,n.type="",n.type=e,n.data=o,n}return r(e,t),e}(cc.Event.EventCustom);o.GameEvent=a,o.eventManager=i.Instance,cc._RF.pop()},{}],GameModule:[function(t,e,o){"use strict";cc._RF.push(e,"64566mmcFVMhZE7goFc3ntd","GameModule");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.gameModule=void 0;var i=t("../manager/Define"),a=t("../util/EventManager"),c=t("../util/NewUtils"),u=function(t){function e(){var e=t.call(this)||this;return e.slotData=[],e.curSelectSlotIdx=-1,e.curSelectCoinIdxs=[],e.moveLock=!1,e.mergeLock=0,e.produceLock=0,e.star=0,e}return r(e,t),e.prototype.parseData=function(e){t.prototype.parseData.call(this,e),this.slotData=e.slotData,this.star=e.star},Object.defineProperty(e.prototype,"canOperate",{get:function(){return this.moveLock?(console.log("\u6b63\u5728\u8fdb\u884c\u79fb\u52a8\u64cd\u4f5c"),!1):0!==this.mergeLock?(console.log("\u6b63\u5728\u8fdb\u884c\u5408\u6210\u64cd\u4f5c"),!1):0===this.produceLock||(console.log("\u6b63\u5728\u53d1\u653e\u7b79\u7801\u64cd\u4f5c"),!1)},enumerable:!1,configurable:!0}),e.prototype.getFirstVaildNumBySlotIdx=function(t){for(var e=this.slotData[t],o=-1,n=-1,r=10,i=9;i>=0;i--)if(0!==e[i]){o=e[i],n=i,r=9-i;break}return{vaildNum:o,vaildIdx:n,vaildSpace:r}},e.prototype.getCurSelectSlotInfo=function(){if(-1===this.curSelectSlotIdx)return null;var t=this.curSelectCoinIdxs.length,e=this.slotData[this.curSelectSlotIdx][this.curSelectCoinIdxs[0]];return{slotIdx:this.curSelectSlotIdx,cnt:t,num:e}},e.prototype.resetSelectStatus=function(){o.gameModule.curSelectSlotIdx=-1,o.gameModule.curSelectCoinIdxs=[]},e.prototype.tidySlotData=function(t){for(var e=0;e<t.srcIdxArr.length;e++)this.slotData[this.curSelectSlotIdx][t.srcIdxArr[e]]=0,this.slotData[t.tarSlotIdx][t.tarIdxArr[e]]=t.numType;a.eventManager.dispatch(i.EventType.MOVE_END,t),this.resetSelectStatus(),a.eventManager.dispatch(i.EventType.CHECK_MERGE)},e.prototype.checkCanMerge=function(){for(var t=[],e=0;e<8;e++)this.checkCanMergeBySlot(e)&&t.push(e);return t},e.prototype.checkCanMergeBySlot=function(t){for(var e=this.slotData[t],o=0;o<10;o++){if(0===e[o])return!1;if(0!==o&&e[o]!==e[o-1])return!1}return!0},e.prototype.getMaxValue=function(){for(var t=0,e=0;e<this.slotData.length;e++)for(var o=0;o<this.slotData[e].length;o++)this.slotData[e][o]>t&&(t=this.slotData[e][o]);return t},e.prototype.getMinValue=function(){for(var t=-1,e=0;e<this.slotData.length;e++)for(var o=0;o<this.slotData[e].length;o++)-1===t&&0!==this.slotData[e][o]&&(t=this.slotData[e][o]),this.slotData[e][o]<t&&0!==this.slotData[e][o]&&(t=this.slotData[e][o]);return t},e.prototype.getSpaceBySlot=function(t){if(this.slotData[t]){for(var e=0;e<this.slotData[t].length;e++)if(0===this.slotData[t][e])return 10-e;return 0}},e.prototype.getSpace=function(){for(var t=0,e=0;e<8;e++)t+=this.getSpaceBySlot(e);return t},e.prototype.produceNewCoinData=function(){var t=this.getMaxValue(),e=this.getSpace();if(t>=15)console.warn("\u5f53\u524d\u5df2\u5408\u621015");else{if(0!==e)return t<5?this.produceStrategyOne(t,e):t<10?this.produceStrategyTwo(t,e):t<14?this.produceStrategyThree(t,e):t<15?this.produceStrategyFour(t,e):void 0;console.warn("\u6ca1\u6709\u5269\u4f59\u7a7a\u95f4\uff0c\u65e0\u6cd5\u751f\u6210\u65b0\u6570\u5b57")}},e.prototype.produceStrategyOne=function(t,e){console.log("\u7b56\u75651:<5");var o=Math.min(1,this.getMinValue()),n=Math.floor(Math.min(25,.6*e));0===n&&(n=1);var r=t-1>0?t-1:1,i=n>=4?4:n;i=Math.min(i,r-o+1);for(var a=c.default.randomIntArrFromSection(i,o,r),u=c.default.randomIntArrFromArr(n,a),l=[],s=0;s<8;s++){var p=this.getSpaceBySlot(s);l.push(p)}var d=[[],[],[],[],[],[],[],[]];do{var f=c.default.randomIntInclusive(0,7);0!==l[f]&&(d[f].push(u.shift()),l[f]--)}while(u.length>0);return d},e.prototype.produceStrategyTwo=function(t,e){console.log("\u7b56\u75652:5<=x<10");var o=Math.min(3,this.getMinValue()),n=Math.floor(Math.min(22,.6*e));0===n&&(n=1);var r=Math.min(t-1,7),i=n>=3?3:n;i=Math.min(i,r-o+1);for(var a=c.default.randomIntArrFromSection(i,o,r),u=c.default.randomIntArrFromArr(n,a),l=[],s=0;s<8;s++){var p=this.getSpaceBySlot(s);l.push(p)}var d=[[],[],[],[],[],[],[],[]];do{var f=c.default.randomIntInclusive(0,7);0!==l[f]&&(d[f].push(u.shift()),l[f]--)}while(u.length>0);return d},e.prototype.produceStrategyThree=function(t,e){console.log("\u7b56\u75653: 10<x<14");var o=Math.min(8,this.getMinValue()),n=Math.floor(Math.min(20,.6*e));0===n&&(n=1);var r=Math.min(t-1,11),i=n>=3?3:n;i=Math.min(i,r-o+1);for(var a=c.default.randomIntArrFromSection(i,o,r),u=c.default.randomIntArrFromArr(n,a),l=[],s=0;s<8;s++){var p=this.getSpaceBySlot(s);l.push(p)}var d=[[],[],[],[],[],[],[],[]];do{var f=c.default.randomIntInclusive(0,7);0!==l[f]&&(d[f].push(u.shift()),l[f]--)}while(u.length>0);return d},e.prototype.produceStrategyFour=function(t,e){console.log("\u7b56\u75651:<15");var o=Math.min(11,this.getMinValue()),n=Math.floor(Math.min(25,.8*e));0===n&&(n=1);for(var r=Math.min(t-1,11),i=n>=3?3:n,a=c.default.randomIntArrFromSection(i,o,r),u=c.default.randomIntArrFromArr(n,a),l=[],s=0;s<8;s++){var p=this.getSpaceBySlot(s);l.push(p)}var d=[[],[],[],[],[],[],[],[]];do{var f=c.default.randomIntInclusive(0,7);0!==l[f]&&(d[f].push(u.shift()),l[f]--)}while(u.length>0);return d},e.prototype.mergeProduceData=function(t){for(var e=0;e<8;e++)for(var o=c.default.deepClone(t[e]),n=0;n<10;n++)if(0===this.slotData[e][n]&&o.length>0){var r=o.shift();this.slotData[e][n]=r}},e.prototype.tidyData=function(){for(var t={},e=0;e<this.slotData.length;e++)for(var o=0;o<10;o++)0!==this.slotData[e][o]&&(t[""+this.slotData[e][o]]?t[""+this.slotData[e][o]]+=1:t[""+this.slotData[e][o]]=1);console.log("dataMap:",t);var n=[];for(var r in t){t[r]>10&&(t[r]=10);var i=[];for(e=0;e<10;e++)e<=t[r]-1?i.push(Number(r)):i.push(0);n.push(i)}if(n.sort(function(t,e){return e[0]-t[0]}),n.length>8)this.slotData=n.slice(0,7);else{for(e=0;e<8;e++)n.length<=e&&n.push([0,0,0,0,0,0,0,0,0,0]);this.slotData=n}console.log("\u6574\u7406\u540e\u7684slotData:",n,this.slotData)},e}(t("./DataModule").default);o.default=u,o.gameModule=new u,cc._RF.pop()},{"../manager/Define":"Define","../util/EventManager":"EventManager","../util/NewUtils":"NewUtils","./DataModule":"DataModule"}],Game:[function(t,e,o){"use strict";cc._RF.push(e,"650a2ldzTZM6Joa8EAO498E","Game");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{u(n.next(t))}catch(e){i(e)}}function c(t){try{u(n.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,c)}u((n=n.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(t){return function(e){return u([t,e])}}function u(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(c){i=[6,c],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var u=t("../dataModule/GameModule"),l=t("../manager/AudioMgr"),s=t("../manager/Define"),p=t("../manager/Uimanager"),d=t("../util/EventManager"),f=t("./GoodsList"),h=t("./MergeProgress"),g=t("./Slot"),y=cc._decorator,v=y.ccclass,m=y.property,M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.uBoxSlot=null,e.uBtnProduce=null,e.uBtnTidyUp=null,e.uBtnMerge=null,e.uBar=null,e.uPanel=null,e.ulblStar=null,e.slots=[],e}return r(e,t),e.prototype.onLoad=function(){return a(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return this.uBtnMerge.on(cc.Node.EventType.TOUCH_END,this.onMerge,this),this.uBtnProduce.on(cc.Node.EventType.TOUCH_END,this.onProduce,this),this.uBtnTidyUp.on(cc.Node.EventType.TOUCH_END,this.onTidy,this),d.eventManager.on(s.EventType.CHECK_MERGE,this.updateBtn,this),d.eventManager.on(s.EventType.MERGE_END,this.updateProgress,this),[4,this.addSlot()];case 1:return t.sent(),this.formatSlotData(),this.updateBtn(),this.updateProgress(),console.log(this.uPanel),this.uPanel.getComponent(f.default).initGoods(),this.ulblStar.string="x "+u.gameModule.star,[2]}})})},e.prototype.start=function(){},e.prototype.addSlot=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r,i,a,u,l;return c(this,function(c){switch(c.label){case 0:e=212,o=(608-4*(t=116))/3,n=this.uBoxSlot.height-2*e+e,r=0,c.label=1;case 1:return r<8?(i=Math.floor(r/4),a=r%4,[4,p.uimanager.loadPrefab("prefab/merge/slot")]):[3,4];case 2:u=c.sent(),l=cc.instantiate(u),this.uBoxSlot.addChild(l),l.x=a*t+o*a,l.y=-e-n*i,this.slots.push(l),c.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.formatSlotData=function(){for(var t=0;t<8;t++)this.slots[t].getComponent(g.default).formatData(t,u.gameModule.slotData[t]);d.eventManager.dispatch(s.EventType.CHECK_MERGE)},e.prototype.updateBtn=function(){var t=u.gameModule.checkCanMerge();this.uBtnMerge.active=t.length>0},e.prototype.updateProgress=function(){this.uBar.getComponent(h.default).updateProress()},e.prototype.onMerge=function(){u.gameModule.canOperate&&(d.eventManager.dispatch(s.EventType.MERGE_COIN),this.uBtnMerge.active=!1)},e.prototype.onProduce=function(){if(u.gameModule.canOperate){l.audioMgr.playSound(l.SoundType.PRODUCE_COIN);for(var t=[],e=0;e<8;e++)for(var o=0;o<10;o++){if(0===u.gameModule.slotData[e][o]){t.push(o);break}9===o&&t.push(9)}var n=u.gameModule.produceNewCoinData();for(e=0;e<this.slots.length;e++)this.slots[e].getComponent(g.default).produce(n[e],this.node.convertToWorldSpaceAR(this.uBtnProduce.getPosition()),t[e]);u.gameModule.mergeProduceData(n),d.eventManager.dispatch(s.EventType.CHECK_MERGE)}},e.prototype.onTidy=function(){u.gameModule.canOperate&&(-1!==u.gameModule.curSelectSlotIdx&&d.eventManager.dispatch(s.EventType.CANCEL_SELECT),u.gameModule.tidyData(),this.formatSlotData())},i([m(cc.Node)],e.prototype,"uBoxSlot",void 0),i([m(cc.Node)],e.prototype,"uBtnProduce",void 0),i([m(cc.Node)],e.prototype,"uBtnTidyUp",void 0),i([m(cc.Node)],e.prototype,"uBtnMerge",void 0),i([m(cc.Node)],e.prototype,"uBar",void 0),i([m(cc.Node)],e.prototype,"uPanel",void 0),i([m(cc.Label)],e.prototype,"ulblStar",void 0),i([v],e)}(cc.Component);o.default=M,cc._RF.pop()},{"../dataModule/GameModule":"GameModule","../manager/AudioMgr":"AudioMgr","../manager/Define":"Define","../manager/Uimanager":"Uimanager","../util/EventManager":"EventManager","./GoodsList":"GoodsList","./MergeProgress":"MergeProgress","./Slot":"Slot"}],GoodsCom:[function(t,e,o){"use strict";cc._RF.push(e,"b87589+qj5GgbqZ/w8AZBbf","GoodsCom");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../dataModule/GoodsModule"),c=cc._decorator,u=c.ccclass,l=c.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.uImgGoods=null,e.ulblName=null,e.ulblStar=null,e.ulblInventory=null,e.uBtnGet=null,e.idx=-1,e}return r(e,t),Object.defineProperty(e.prototype,"goodsData",{get:function(){return a.goodsModule.goods[this.idx]},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onSelect,this),this.uBtnGet.on(cc.Node.EventType.TOUCH_END,this.onGet,this)},e.prototype.init=function(t){this.idx=t,this.formatGoodsInfo()},e.prototype.formatGoodsInfo=function(){var t=this,e=this.goodsData,o="images/goods/img_goods_"+e.id;cc.resources.load(o,cc.SpriteFrame,function(e,n){e?console.error("url:",o,"/err:"):t.uImgGoods.spriteFrame=n}),this.ulblName.string=e.name,this.ulblStar.string="x "+e.star},e.prototype.onSelect=function(){console.log("[DEBUG] \u663e\u793a\u5546\u54c1\u8be6\u60c5",this.goodsData)},e.prototype.onGet=function(){console.log("[DEBUG] \u5151\u6362\u5546\u54c1"+this.goodsData.name)},i([l(cc.Label)],e.prototype,"label",void 0),i([l(cc.Sprite)],e.prototype,"uImgGoods",void 0),i([l(cc.Label)],e.prototype,"ulblName",void 0),i([l(cc.Label)],e.prototype,"ulblStar",void 0),i([l(cc.Label)],e.prototype,"ulblInventory",void 0),i([l(cc.Node)],e.prototype,"uBtnGet",void 0),i([u],e)}(cc.Component);o.default=s,cc._RF.pop()},{"../dataModule/GoodsModule":"GoodsModule"}],GoodsList:[function(t,e,o){"use strict";cc._RF.push(e,"c429fRntiVHaLkAc6vP2F5Q","GoodsList");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{u(n.next(t))}catch(e){i(e)}}function c(t){try{u(n.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,c)}u((n=n.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(t){return function(e){return u([t,e])}}function u(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(c){i=[6,c],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var u=t("../dataModule/GoodsModule"),l=t("../manager/Uimanager"),s=t("./GoodsCom"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.uPanel=null,e}return r(e,t),e.prototype.onLoad=function(){},e.prototype.initGoods=function(){return a(this,void 0,void 0,function(){var t,e;return c(this,function(o){switch(o.label){case 0:this.uPanel.content.removeAllChildren(),t=0,o.label=1;case 1:return t<u.goodsModule.goods.length?[4,this.produceGoods()]:[3,4];case 2:(e=o.sent()).getComponent(s.default).init(t),this.uPanel.content.addChild(e),e.x=t*e.width+e.width/2,this.uPanel.content.width=(t+1)*e.width,o.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},e.prototype.produceGoods=function(){return a(this,void 0,Promise,function(){var t;return c(this,function(e){switch(e.label){case 0:return[4,l.uimanager.loadPrefab("prefab/merge/goodsCom")];case 1:return t=e.sent(),[2,cc.instantiate(t)]}})})},i([f(cc.Label)],e.prototype,"label",void 0),i([f(cc.ScrollView)],e.prototype,"uPanel",void 0),i([d],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../dataModule/GoodsModule":"GoodsModule","../manager/Uimanager":"Uimanager","./GoodsCom":"GoodsCom"}],GoodsModule:[function(t,e,o){"use strict";cc._RF.push(e,"beefbM59wVK1oMpVwTVCzYm","GoodsModule");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.goodsModule=void 0;var i=function(t){function e(){var e=t.call(this)||this;return e.goods=[],e}return r(e,t),e.prototype.parseData=function(e){t.prototype.parseData.call(this,e),this.goods=e.goods},e}(t("./DataModule").default);o.default=i,o.goodsModule=new i,cc._RF.pop()},{"./DataModule":"DataModule"}],MergeProgress:[function(t,e,o){"use strict";cc._RF.push(e,"77cddiCwBxKFLf9oKyUt+gA","MergeProgress");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../dataModule/GameModule"),c=cc._decorator,u=c.ccclass,l=c.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ulblTar=null,e.uImgBar=null,e}return r(e,t),e.prototype.onLoad=function(){this.uImgBar.width=0,this.ulblTar.node.color=(new cc.Color).fromHEX("#4b91e4")},e.prototype.updateProress=function(){var t=a.gameModule.getMaxValue(),e=Math.floor(t/15*585);cc.tween(this.uImgBar).to(.3,{width:e},{easing:cc.easing.cubicInOut}).start()},i([l(cc.Label)],e.prototype,"ulblTar",void 0),i([l(cc.Node)],e.prototype,"uImgBar",void 0),i([u],e)}(cc.Component);o.default=s,cc._RF.pop()},{"../dataModule/GameModule":"GameModule"}],MergeScene:[function(t,e,o){"use strict";cc._RF.push(e,"0af54diud5JN6SYpIPIvcRc","MergeScene");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{u(n.next(t))}catch(e){i(e)}}function c(t){try{u(n.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,c)}u((n=n.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(t){return function(e){return u([t,e])}}function u(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(c){i=[6,c],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var u=t("../dataModule/PlayerModule"),l=t("../define/TypeDefine"),s=t("../manager/AudioMgr"),p=t("../manager/Uimanager"),d=cc._decorator,f=d.ccclass,h=(d.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onLoad=function(){console.log("load mergeScene")},e.prototype.start=function(){var t=this;p.uimanager.init(this.node),u.playerModule.login(function(){s.audioMgr.init(),t.initGamePanel()})},e.prototype.update=function(){p.uimanager.udpateLayerShow()},e.prototype.initGamePanel=function(){return a(this,void 0,void 0,function(){var t,e;return c(this,function(o){switch(o.label){case 0:return[4,p.uimanager.loadPrefab("prefab/merge/game")];case 1:return t=o.sent(),e=cc.instantiate(t),p.uimanager.add(e,l.LAYER.UI),e.setPosition(new cc.Vec2(0,0)),[2]}})})},i([f],e)}(cc.Component));o.default=h,cc._RF.pop()},{"../dataModule/PlayerModule":"PlayerModule","../define/TypeDefine":"TypeDefine","../manager/AudioMgr":"AudioMgr","../manager/Uimanager":"Uimanager"}],NewUtils:[function(t,e,o){"use strict";cc._RF.push(e,"85100MR3/pMT5YtpOTF2CAl","NewUtils"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.deepClone=function(t,e){if(void 0===e&&(e=new WeakMap),"object"!=typeof t)return t;if(null===t)return t;if(e.get(t))return e.get(t);if(t instanceof Date)return new Date(t);if(t instanceof RegExp)return new RegExp(t);var o=new t.constructor;for(var n in e.set(t,o),t)t[n]&&(o[n]=this.deepClone(t[n],e));return o},t.randomIntInclusive=function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t},t.randomIntArrFromSection=function(t,e,o){var n=[];do{var r=this.randomIntInclusive(e,o);-1===n.indexOf(r)&&n.push(r)}while(n.length<t);return n},t.randomIntArrInclusive=function(t,e,o){var n=[];do{n.push(this.randomIntInclusive(e,o))}while(n.length<t);return n},t.randomIntArrFromArr=function(t,e){var o=[];do{var n=this.randomIntInclusive(0,e.length-1);o.push(e[n])}while(o.length<t);return o},t}();o.default=n,cc._RF.pop()},{}],PlayerModule:[function(t,e,o){"use strict";cc._RF.push(e,"b9091AjnB9Hj67aGxm4Vaq5","PlayerModule");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.playerModule=void 0;var i=t("./DataModule"),a=t("./GameModule"),c=t("./GoodsModule"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.parseData=function(e){t.prototype.parseData.call(this,e)},e.prototype.login=function(t){var e={star:0,slotData:[[1,1,0,0,0,0,0,0,0,0],[2,2,2,0,0,0,0,0,0,0],[1,1,2,2,0,0,0,0,0,0],[2,2,2,3,3,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]],goods:[{id:1,star:1,total:100,used:0,name:"1\u76d2\u7eb8\u5dfe",desc:"\u5546\u54c11",url:""},{id:2,star:3,total:100,used:0,name:"1\u7bb1\u725b\u5976",desc:"\u5546\u54c12",url:""},{id:3,star:5,total:100,used:0,name:"\u4e00\u7bb1\u7ea2\u725b",desc:"\u5546\u54c13",url:""},{id:4,star:5,total:100,used:0,name:"\u4e00\u7bb1\u997c\u5e72",desc:"\u5546\u54c14",url:""},{id:5,star:8,total:100,used:0,name:"\u661f\u5df4\u514b100\u5238",desc:"\u5546\u54c15",url:""},{id:6,star:10,total:100,used:0,name:"\u7535\u5b50\u624b\u8868",desc:"\u5546\u54c16",url:""},{id:7,star:10,total:100,used:0,name:"\u5317\u4eac1\u65e5\u6e38",desc:"\u5546\u54c17",url:""},{id:8,star:20,total:100,used:0,name:"5\u514b\u9ec4\u91d1",desc:"\u5546\u54c18",url:""}]};a.gameModule.parseData(e),c.goodsModule.parseData(e),t&&t()},e}(i.default);o.default=u,o.playerModule=new u,cc._RF.pop()},{"./DataModule":"DataModule","./GameModule":"GameModule","./GoodsModule":"GoodsModule"}],Slot:[function(t,e,o){"use strict";cc._RF.push(e,"dcad5zWGmVAHYWaggo3w0WB","Slot");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{u(n.next(t))}catch(e){i(e)}}function c(t){try{u(n.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,c)}u((n=n.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(t){return function(e){return u([t,e])}}function u(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(c){i=[6,c],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var u=t("../dataModule/GameModule"),l=t("../manager/AudioMgr"),s=t("../manager/Define"),p=t("../manager/Uimanager"),d=t("../util/EventManager"),f=t("./Coin"),h=cc._decorator,g=h.ccclass,y=h.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.idx=0,e.coinOriginalPos=[[58,197],[58,178],[58,159.3],[58,140],[58,121],[58,102],[58,83],[58,64],[58,45],[58,26]],e.coin0=null,e.coin1=null,e.coin2=null,e.coin3=null,e.coin4=null,e.coin5=null,e.coin6=null,e.coin7=null,e.coin8=null,e.coin9=null,e.uImgSlotSelect=null,e.uImgSlotMerge=null,e}return r(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.selectAction,this),d.eventManager.on(s.EventType.MOVE_COIN,this.onMove,this),d.eventManager.on(s.EventType.MOVE_END,this.onMoveEnd,this),d.eventManager.on(s.EventType.CHECK_MERGE,this.onUpdateMergeStatus,this),d.eventManager.on(s.EventType.MERGE_COIN,this.onMerge,this),d.eventManager.on(s.EventType.MOVE_CHECK_FAIL,this.canNotMove,this),d.eventManager.on(s.EventType.CANCEL_SELECT,this.onDeSelect,this)},e.prototype.start=function(){},e.prototype.formatData=function(t,e){var o=this;this.idx=t;for(var n=function(t){0!==e[t]?r["coin"+t].getComponent(f.default).init(r.idx,e[t],function(){o["coin"+t].active=!0}):r["coin"+t].active=!1,r["coin"+t].setPosition(cc.v2(r.coinOriginalPos[t][0],r.coinOriginalPos[t][1]))},r=this,i=0;i<10;i++)n(i);this.node.setSiblingIndex(this.idx)},e.prototype.selectAction=function(){-1===u.gameModule.curSelectSlotIdx?this.onSelect():u.gameModule.curSelectSlotIdx===this.idx?this.onDeSelect():this.onCheckMove()},e.prototype.onSelect=function(){var t=u.gameModule.slotData[this.idx];if(0!==t[0])if(u.gameModule.mergeLock)console.log("\u6b63\u5728\u5408\u5e76\u4e2d\uff0c\u65e0\u6cd5\u9009\u4e2d");else{u.gameModule.curSelectSlotIdx=this.idx,this.uImgSlotSelect.active=!0,this.node.setSiblingIndex(8),u.gameModule.curSelectCoinIdxs=[];for(var e=9;e>=0;e--)if(0!==t[e])if(0===u.gameModule.curSelectCoinIdxs.length)u.gameModule.curSelectCoinIdxs.push(e);else{if(t[e]!==t[u.gameModule.curSelectCoinIdxs[u.gameModule.curSelectCoinIdxs.length-1]])break;u.gameModule.curSelectCoinIdxs.push(e)}for(console.log("\u9009\u4e2d\u4e86\u7b2c"+this.idx+"\u4e2a\u69fd\u7684",u.gameModule.curSelectCoinIdxs),e=0;e<u.gameModule.curSelectCoinIdxs.length;e++){var o=this.coinOriginalPos[u.gameModule.curSelectCoinIdxs[e]][1]+25;cc.tween(this["coin"+u.gameModule.curSelectCoinIdxs[e]]).to(.5,{y:o},{easing:"backOut"}).start()}}else console.log("\u9009\u4e2d\u4e86\u7a7a\u7684\u69fd\u4f4d")},e.prototype.onDeSelect=function(){console.log("\u53d6\u6d88\u9009\u62e9");for(var t=0;t<10;t++){var e=this.coinOriginalPos[t][1];cc.tween(this["coin"+t]).to(.5,{y:e},{easing:"backOut"}).start()}this.uImgSlotSelect.active=!1,u.gameModule.curSelectSlotIdx=-1},e.prototype.onCheckMove=function(){if(-1===u.gameModule.slotData[this.idx].indexOf(0))return console.log("\u7b79\u7801\u6570\u91cf\u5df2\u6ee1\uff0c\u4e0d\u53ef\u79fb\u52a8"),void d.eventManager.dispatch(s.EventType.MOVE_CHECK_FAIL);var t=u.gameModule.getFirstVaildNumBySlotIdx(this.idx),e=u.gameModule.getCurSelectSlotInfo();if(-1!==t.vaildNum&&t.vaildNum!==e.num)return console.log("\u7b79\u7801\u7c7b\u578b\u4e0d\u4e00\u81f4, \u4e0d\u53ef\u79fb\u52a8"),void d.eventManager.dispatch(s.EventType.MOVE_CHECK_FAIL);if(u.gameModule.moveLock)console.log("\u6b63\u5728\u79fb\u52a8\u4e2d\uff0c\u65e0\u6cd5\u4ea7\u751f\u66f4\u591a\u79fb\u52a8");else{for(var o=Math.min(t.vaildSpace,e.cnt),n=[],r=[],i=[],a=t.vaildIdx+1,c=0;c<o;c++){var l=this.coinOriginalPos[a][0],p=this.coinOriginalPos[a][1],f=this.node.convertToWorldSpaceAR(cc.v2(l,p));n.push(f),r.push(a),i.push(u.gameModule.curSelectCoinIdxs[c]),a++}var h={moveCnt:o,tarPos:n,tarIdxArr:r,srcIdxArr:i,numType:e.num,tarSlotIdx:this.idx};d.eventManager.dispatch(s.EventType.MOVE_COIN,h)}},e.prototype.canNotMove=function(){var t=this;if(u.gameModule.curSelectSlotIdx===this.idx&&-1!==u.gameModule.curSelectSlotIdx){l.audioMgr.playSound(l.SoundType.ERROR);for(var e=function(e){var n=o["coin"+u.gameModule.curSelectCoinIdxs[e]],r=n.x;cc.tween(n).to(.05,{x:r-10}).to(.1,{x:r+10}).to(.1,{x:r-10}).to(.05,{x:r}).call(function(){e===u.gameModule.curSelectCoinIdxs.length-1&&t.onDeSelect()}).start()},o=this,n=0;n<u.gameModule.curSelectCoinIdxs.length;n++)e(n)}},e.prototype.onMove=function(t){var e=this,o=t.data;if(this.idx===u.gameModule.curSelectSlotIdx){console.log("onMove: "+u.gameModule.curSelectSlotIdx+" -> "+o.tarSlotIdx),l.audioMgr.playSound(l.SoundType.MOVE_COIN),u.gameModule.moveLock=!0;for(var n=o.moveCnt,r=o.tarPos,i=[],a=r.length-1;a>=0;a--)i.push(this.node.convertToNodeSpaceAR(r[a]));var c=u.gameModule.curSelectCoinIdxs[0],s=function(t){cc.tween(p["coin"+c]).delay(.03*t).to(.1,{position:i[t]}).call(function(){t===n-1&&(u.gameModule.tidySlotData({tarSlotIdx:o.tarSlotIdx,numType:o.numType,srcIdxArr:o.srcIdxArr,tarIdxArr:o.tarIdxArr}),e.onDeSelect(),u.gameModule.moveLock=!1)}).start(),c--},p=this;for(a=0;a<n;a++)s(a)}},e.prototype.onMoveEnd=function(){console.log("onMoveEnd"),this.formatData(this.idx,u.gameModule.slotData[this.idx])},e.prototype.onUpdateMergeStatus=function(){var t=u.gameModule.checkCanMergeBySlot(this.idx);this.uImgSlotMerge.active=t,this.showMergeHintAction(t)},e.prototype.showMergeHintAction=function(t){var e=this;t?(this.uImgSlotMerge.opacity=0,cc.tween(this.uImgSlotMerge).to(1,{opacity:255}).to(1,{opacity:0}).call(function(){e.showMergeHintAction(t)}).start()):(cc.tween(this.uImgSlotMerge).stop(),this.uImgSlotMerge.active=t)},e.prototype.onMerge=function(){var t=this;if(u.gameModule.checkCanMergeBySlot(this.idx)){l.audioMgr.playSound(l.SoundType.MERGE_COIN),u.gameModule.mergeLock+=1;for(var e=function(e){cc.tween(o["coin"+e]).delay(.05*(9-e)).to(.1,{scale:0}).call(function(){t["coin"+e].active=!1,t["coin"+e].scale=1,0===e&&t.onMergeFinish()}).start()},o=this,n=9;n>=0;n--)e(n)}},e.prototype.onMergeFinish=function(){var t=this,e=u.gameModule.slotData[this.idx][0]+1;u.gameModule.slotData[this.idx]=[e,e,0,0,0,0,0,0,0,0],console.log("\u69fd"+this.idx+" \u5408\u6210"+e),this.coin0.scale=0,this.coin1.scale=0,this.coin0.getComponent(f.default).init(this.idx,e,function(){t.coin0.active=!0}),this.coin1.getComponent(f.default).init(this.idx,e,function(){t.coin1.active=!0}),cc.tween(this.coin0).to(.5,{scale:1},{easing:"backOut"}).start(),cc.tween(this.coin1).to(.5,{scale:1},{easing:"backOut"}).call(function(){u.gameModule.mergeLock-=1,u.gameModule.mergeLock<0&&(u.gameModule.mergeLock=0),0===u.gameModule.mergeLock&&d.eventManager.dispatch(s.EventType.MERGE_END)}).start(),this.uImgSlotMerge.active=!1,d.eventManager.dispatch(s.EventType.CHECK_MERGE)},e.prototype.produce=function(t,e,o){return a(this,void 0,void 0,function(){var n,r,i,a,s,p=this;return c(this,function(d){switch(d.label){case 0:if(console.log(this.idx,t),0===t.length)return console.log(this.idx+"\u69fd\u65e0\u65b0\u7b79\u7801"),l.audioMgr.playSound(l.SoundType.ERROR),[2];console.log(this.idx+" \u751f\u6210\u4e86",t),n=this.node.convertToNodeSpaceAR(e),r=0,i=function(e){var i,l,s,d,h;return c(this,function(c){switch(c.label){case 0:return[4,a.produceCoin()];case 1:return i=c.sent(),l=i.getComponent(f.default),a.node.addChild(i),l.node.setPosition(n),l.node.active=!1,l.init(a.idx,t[e],function(){l.node.active=!0}),s=o+r,d=a.coinOriginalPos[o+r],h=cc.v2(d[0],d[1]),u.gameModule.produceLock+=1,cc.tween(l.node).delay(.1*r).to(.5,{position:h},{easing:"cubicInOut"}).call(function(){p["coin"+s].getComponent(f.default).init(p.idx,t[e],function(){p["coin"+s].active=!0,l.node.active=!1,l.node.destroy()}),u.gameModule.produceLock-=1,u.gameModule.produceLock<0&&(u.gameModule.produceLock=0)}).start(),r++,[2]}})},a=this,s=0,d.label=1;case 1:return s<t.length?[5,i(s)]:[3,4];case 2:d.sent(),d.label=3;case 3:return s++,[3,1];case 4:return[2]}})})},e.prototype.produceCoin=function(){return a(this,void 0,Promise,function(){var t;return c(this,function(e){switch(e.label){case 0:return[4,p.uimanager.loadPrefab("prefab/merge/coin")];case 1:return t=e.sent(),[2,cc.instantiate(t)]}})})},i([y(cc.Node)],e.prototype,"coin0",void 0),i([y(cc.Node)],e.prototype,"coin1",void 0),i([y(cc.Node)],e.prototype,"coin2",void 0),i([y(cc.Node)],e.prototype,"coin3",void 0),i([y(cc.Node)],e.prototype,"coin4",void 0),i([y(cc.Node)],e.prototype,"coin5",void 0),i([y(cc.Node)],e.prototype,"coin6",void 0),i([y(cc.Node)],e.prototype,"coin7",void 0),i([y(cc.Node)],e.prototype,"coin8",void 0),i([y(cc.Node)],e.prototype,"coin9",void 0),i([y(cc.Node)],e.prototype,"uImgSlotSelect",void 0),i([y(cc.Node)],e.prototype,"uImgSlotMerge",void 0),i([g],e)}(cc.Component);o.default=v,cc._RF.pop()},{"../dataModule/GameModule":"GameModule","../manager/AudioMgr":"AudioMgr","../manager/Define":"Define","../manager/Uimanager":"Uimanager","../util/EventManager":"EventManager","./Coin":"Coin"}],TouchEffect:[function(t,e,o){"use strict";cc._RF.push(e,"ba1070sT7NPqKINxiKgj14u","TouchEffect");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,c=a.ccclass,u=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scaleTime=.07,e.initScaleX=1,e.initScaleY=1,e.dS=.9,e}return r(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this)},e.prototype.start=function(){this.initScaleX=this.node.scaleX,this.initScaleY=this.node.scaleY,cc.tween(this.node).stop()},e.prototype.onTouchStart=function(){var t=.9*this.node.scaleX,e=.9*this.node.scaleY;cc.tween(this.node).to(this.scaleTime,{scaleX:t,scaleY:e}).to(this.scaleTime,{scaleX:this.initScaleX,scaleY:this.initScaleY}).start()},e.prototype.onTouchEnd=function(){cc.tween(this.node).to(this.scaleTime,{scaleX:this.initScaleX,scaleY:this.initScaleY}).start()},i([u()],e.prototype,"scaleTime",void 0),i([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],TypeDefine:[function(t,e,o){"use strict";cc._RF.push(e,"26083HQUZhNsJndxpxVjML2","TypeDefine"),Object.defineProperty(o,"__esModule",{value:!0}),o.LAYER=void 0,function(t){t.UI="ui",t.DIALOG="dialog",t.TIP="tip",t.GUIDE="guide"}(o.LAYER||(o.LAYER={})),cc._RF.pop()},{}],Uimanager:[function(t,e,o){"use strict";cc._RF.push(e,"f6b0eaEb8lOraTr9sfkeyyf","Uimanager");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{u(n.next(t))}catch(e){i(e)}}function c(t){try{u(n.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,c)}u((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(t){return function(e){return u([t,e])}}function u(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(c){i=[6,c],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.uimanager=void 0;var i=t("../define/TypeDefine"),a=function(){function t(){this.scene=null,this.layerArr=[]}return Object.defineProperty(t,"instance",{get:function(){return this._ins||(this._ins=new t),this._ins},enumerable:!1,configurable:!0}),t.prototype.init=function(t){this.scene=t,this.initLayer()},t.prototype.initLayer=function(){this.layerArr=[];var t=new cc.Node(i.LAYER.UI);t.width=this.scene.width,t.height=this.scene.height,this.scene.addChild(t),this.layerArr.push(t);var e=new cc.Node(i.LAYER.DIALOG);e.width=this.scene.width,e.height=this.scene.height,this.scene.addChild(e),this.layerArr.push(e);var o=new cc.Node(i.LAYER.TIP);o.width=this.scene.width,o.height=this.scene.height,this.scene.addChild(o),this.layerArr.push(o);var n=new cc.Node(i.LAYER.GUIDE);n.width=this.scene.width,n.height=this.scene.height,this.scene.addChild(n),this.layerArr.push(n)},t.prototype.getLayer=function(t){return this.scene.getChildByName(t)},t.prototype.add=function(t,e){var o=this.getLayer(e);o?o.addChild(t):console.warn("UIManager: \u6ca1\u6709\u8fd9\u4e2a\u5c42\u7ea7",e)},t.prototype.udpateLayerShow=function(){for(var t=0;t<this.layerArr.length;t++)this.layerArr[t].active=this.layerArr[t].childrenCount>0},t.prototype.loadPrefab=function(t){return n(this,void 0,Promise,function(){var e=this;return r(this,function(){return[2,new Promise(function(o,i){return n(e,void 0,void 0,function(){var e=this;return r(this,function(a){switch(a.label){case 0:return[4,n(e,void 0,void 0,function(){return r(this,function(){return[2,new Promise(function(e,o){var n=setTimeout(function(){console.debug("[loadPefab timeout] "+t+"\u52a0\u8f7d\u8d85\u65f6"),o("loadPefab \u8fde\u63a5\u8d85\u65f6"+t)},1e4);cc.resources.load(t,function(t,r){clearTimeout(n),t?o(t):e(r)})})]})}).then(function(t){o(t)}).catch(function(t){i(t)})];case 1:return a.sent(),[2]}})})})]})})},t}();o.default=a,o.uimanager=a.instance,cc._RF.pop()},{"../define/TypeDefine":"TypeDefine"}],logger:[function(t,e,o){"use strict";cc._RF.push(e,"ceb40nCofFAQac+7tmvBl9q","logger");var n=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var n=Array(t),r=0;for(e=0;e<o;e++)for(var i=arguments[e],a=0,c=i.length;a<c;a++,r++)n[r]=i[a];return n};Object.defineProperty(o,"__esModule",{value:!0}),o.Logger=void 0;var r=function(){function t(){}return t.Init=function(t){this.DEBUG_LOG=t},t.debug=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];t.DEBUG_LOG&&console.log.apply(console,e)},t.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.log.apply(console,t)},t.warn=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];t.DEBUG_LOG&&console.warn.apply(console,e)},t.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.error.apply(console,t)},t.assert=function(e,o){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];t.DEBUG_LOG&&console.assert.apply(console,n([e,o],r))},t.DEBUG_LOG=!0,t}();o.Logger=r,cc._RF.pop()},{}]},{},["DataModule","GameModule","GoodsModule","PlayerModule","TypeDefine","Coin","Game","GoodsCom","GoodsList","MergeProgress","MergeScene","Slot","AudioMgr","Define","Uimanager","TouchEffect","EventManager","NewUtils","logger"]);