{"version":3,"sources":["assets/script/merge/dataModule/GameModule.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { EventType } from '../manager/Define';\nimport { eventManager, GameEvent } from '../util/EventManager';\nimport NewUtils from '../util/NewUtils';\nimport DataModule from './DataModule';\n\nexport default class GameModule extends DataModule {\n    // 用户的筹码槽位数据 1~10\n    public slotData = [];\n\n    // 当前正在选中的筹码槽位\n    curSelectSlotIdx: number = -1;\n    // 当前选中的筹码信息\n    curSelectCoinIdxs: number[] = [];\n\n    // 移动锁\n    moveLock: boolean = false;\n    // 合成引用计数\n    mergeLock: number = 0;\n    // 生成筹码效果引用计数\n    produceLock: number = 0;\n\n    // 当前星星数\n    star: number = 0;\n\n    constructor() {\n        super();\n    }\n\n    parseData(data: any): void {\n        super.parseData(data);\n        this.slotData = data.slotData;\n        this.star = data.star;\n    }\n\n    // 交互操作的检测，当前如果有正在发生的交互行为，则不允许触发更多的行为\n    get canOperate(): boolean {\n        // 正在有移动行为发生\n        if (this.moveLock) {\n            console.log('正在进行移动操作');\n            return false;\n        }\n\n        // 正在进行合成操作\n        if (this.mergeLock !== 0) {\n            console.log('正在进行合成操作');\n            return false;\n        }\n\n        if (this.produceLock !== 0) {\n            console.log('正在发放筹码操作');\n            return false;\n        }\n\n        return true;\n    }\n\n    /**\n     * @description 通过槽id 获取第一个有效的筹码信息\n     * @param slotIdx: 需要获取第一个有效的筹码信息的槽id\n     * @return vaildNum: 该槽位的有效数字、vaildIdx: 有效数字的索引、vaildSPace: 剩余可容纳的筹码空间\n     */\n    getFirstVaildNumBySlotIdx(slotIdx: number): { vaildNum: number, vaildIdx: number, vaildSpace: number } {\n        const slotData = this.slotData[slotIdx];\n\n        let vaildNum: number = -1;\n        let vaildIdx: number = -1;\n        let vaildSpace: number = 10;\n\n        for (let i = 9; i >= 0; i--) {\n            if (slotData[i] === 0) continue;\n\n            vaildNum = slotData[i];\n            vaildIdx = i;\n            vaildSpace = 9 - i;\n            break;\n        }\n\n        return { vaildNum, vaildIdx, vaildSpace };\n    }\n\n    /**\n     * @description 获取当前选中的待移动的槽位筹码信息\n     * @returns slotIdx: 当前选中的槽位索引、  cnt: 待移动的筹码数量、  num: 待移动的数字类型\n     */\n    getCurSelectSlotInfo(): { slotIdx: number, cnt: number, num: number } {\n        if (this.curSelectSlotIdx === -1) return null;\n        const cnt = this.curSelectCoinIdxs.length;\n        const num = this.slotData[this.curSelectSlotIdx][this.curSelectCoinIdxs[0]];\n        return { slotIdx: this.curSelectSlotIdx, cnt, num };\n    }\n\n    // 重置当前筹码选择状态\n    resetSelectStatus(): void {\n        gameModule.curSelectSlotIdx = -1;\n        gameModule.curSelectCoinIdxs = [];\n    }\n\n    // 筹码移动完成，整理移动后的数据\n    tidySlotData(ed: { tarSlotIdx: number, numType: number, srcIdxArr: number[], tarIdxArr: number[] }) {\n        for (let i = 0; i < ed.srcIdxArr.length; i++) {\n            this.slotData[this.curSelectSlotIdx][ed.srcIdxArr[i]] = 0;\n            this.slotData[ed.tarSlotIdx][ed.tarIdxArr[i]] = ed.numType;\n        }\n\n        // 刷新筹码显示情况\n        eventManager.dispatch(EventType.MOVE_END, ed);\n\n        // 重置当前选中状态\n        this.resetSelectStatus();\n\n        // 检测是否可以合成\n        eventManager.dispatch(EventType.CHECK_MERGE);\n    }\n\n    // 检测是否有可以合成的槽位\n    checkCanMerge(): number[] {\n        const result = [];\n        for (let i = 0; i < 8; i++) {\n            const can = this.checkCanMergeBySlot(i);\n            if (can) result.push(i);\n        }\n\n        return result;\n    }\n\n    // 通过槽位来检测是否可以进行合成\n    checkCanMergeBySlot(slotId: number): boolean {\n        const slotData = this.slotData[slotId];\n        for (let i = 0; i < 10; i++) {\n            if (slotData[i] === 0) return false;\n            if (i === 0) continue;\n            if (slotData[i] !== slotData[i - 1]) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    // 获取当前最大数字\n    getMaxValue(): number {\n        let maxValue = 0;\n        for (let i = 0; i < this.slotData.length; i++) {\n            for (let j = 0; j < this.slotData[i].length; j++) {\n                if (this.slotData[i][j] > maxValue) {\n                    maxValue = this.slotData[i][j];\n                }\n\n            }\n\n        }\n        return maxValue;\n    }\n\n    // 获取当前最小数字\n    getMinValue(): number {\n        let minValue = -1;\n        for (let i = 0; i < this.slotData.length; i++) {\n            for (let j = 0; j < this.slotData[i].length; j++) {\n                if (minValue === -1 && this.slotData[i][j] !== 0) {\n                    minValue = this.slotData[i][j];\n                }\n                if (this.slotData[i][j] < minValue && this.slotData[i][j] !== 0) {\n                    minValue = this.slotData[i][j];\n                }\n\n            }\n\n        }\n        return minValue;\n    }\n\n    getSpaceBySlot(id: number): number {\n        if (!this.slotData[id]) return;\n        for (let i = 0; i < this.slotData[id].length; i++) {\n            if (this.slotData[id][i] === 0) {\n                return 10 - i;\n            }\n        }\n\n        return 0;\n    }\n\n    // 获取当前剩余空间\n    getSpace(): number {\n        let space = 0;\n        for (let i = 0; i < 8; i++) {\n            space += this.getSpaceBySlot(i);\n        }\n        return space;\n    }\n\n    //TODO: 生成新的筹码数据 （服务器逻辑）\n    produceNewCoinData(): number[][] {\n        const maxValue = this.getMaxValue();\n        const space = this.getSpace();\n\n        if (maxValue >= 15) {\n            console.warn('当前已合成15');\n            return;\n        }\n\n        if (space === 0) {\n            console.warn('没有剩余空间，无法生成新数字')\n            return;\n        }\n\n        if (maxValue < 5) {\n            return this.produceStrategyOne(maxValue, space);\n        } else if (maxValue < 10) {\n            return this.produceStrategyTwo(maxValue, space);\n        } else if (maxValue < 14) {\n            return this.produceStrategyThree(maxValue, space);\n        } else if (maxValue < 15) {\n            return this.produceStrategyFour(maxValue, space);\n        }\n    }\n\n    /**\n     * @description 小于5 策略\n     * 1、生成数量 min(space*30,8);\n     * 2、生成类型 <= 3\n     * 3、最小数 = 当前场景最小数-1\n     * \n     * @param max: 当前场景中最大的筹码数值\n     * @param space: 当前总的空间数\n     * @returns \n     */\n    produceStrategyOne(max: number, space: number): number[][] {\n        console.log('策略1:<5');\n        // 场景中最小值\n        let min = Math.min(1, this.getMinValue());\n\n        // 总共需要生成的数字数量\n        let totalCnt = Math.floor(Math.min(25, space * 0.6));\n        if (totalCnt === 0) totalCnt = 1;\n\n        // 新生成的数字类型限定在比当前场景中最大的数字小1\n        const limitMax = max - 1 > 0 ? max - 1 : 1;\n\n        // 生成数字的类型数量 1、2、3、4\n        let typeCnt = totalCnt >= 4 ? 4 : totalCnt;\n        typeCnt = Math.min(typeCnt, limitMax - min + 1);\n\n        // 数字种类\n        const types = NewUtils.randomIntArrFromSection(typeCnt, min, limitMax);\n\n        // 生成全部的随机筹码值\n        let allNewCoin = NewUtils.randomIntArrFromArr(totalCnt, types);\n\n        // 确定当前的剩余空间情况\n        let spaceInfo = [];\n        for (let i = 0; i < 8; i++) {\n            const perSlotSpace = this.getSpaceBySlot(i);\n            spaceInfo.push(perSlotSpace);\n        }\n\n        // 随机将已经生成的数字填充到相应的空位置处(一定是可以放得下的，剩余空间>=生成的数字数量)\n        const result = [[], [], [], [], [], [], [], []];\n        do {\n            const slotIdx = NewUtils.randomIntInclusive(0, 7);\n            if (spaceInfo[slotIdx] === 0) continue;\n\n            result[slotIdx].push(allNewCoin.shift());\n            spaceInfo[slotIdx]--;\n        } while (allNewCoin.length > 0)\n\n        return result;\n    }\n\n    // 小于10的策略\n    produceStrategyTwo(max: number, space: number): number[][] {\n        console.log('策略2:5<=x<10');\n\n        // 场景中最小值\n        let min = Math.min(3, this.getMinValue());\n\n        // 总共需要生成的数字数量\n        let totalCnt = Math.floor(Math.min(22, space * 0.6));\n        if (totalCnt === 0) totalCnt = 1;\n\n        // 最大值 7\n        const limitMax = Math.min(max - 1, 7);\n\n        // 生成数字的类型数量(既不能超过可生成的总数量，也不能超过当前允许出现的类型上限)\n        let typeCnt = totalCnt >= 3 ? 3 : totalCnt;\n        typeCnt = Math.min(typeCnt, limitMax - min + 1);\n\n        // 实际生成的种类\n        const types = NewUtils.randomIntArrFromSection(typeCnt, min, limitMax);\n\n        // 生成全部的随机筹码值\n        let allNewCoin = NewUtils.randomIntArrFromArr(totalCnt, types);\n\n        // 确定当前的剩余空间情况\n        let spaceInfo = [];\n        for (let i = 0; i < 8; i++) {\n            const perSlotSpace = this.getSpaceBySlot(i);\n            spaceInfo.push(perSlotSpace);\n        }\n\n        // 随机将已经生成的数字填充到相应的空位置处(一定是可以放得下的，剩余空间>=生成的数字数量)\n        const result = [[], [], [], [], [], [], [], []];\n        do {\n            const slotIdx = NewUtils.randomIntInclusive(0, 7);\n            if (spaceInfo[slotIdx] === 0) continue;\n\n            result[slotIdx].push(allNewCoin.shift());\n            spaceInfo[slotIdx]--;\n        } while (allNewCoin.length > 0)\n\n        return result;\n\n    }\n\n    // 小于14的策略\n    produceStrategyThree(max: number, space: number): number[][] {\n        console.log('策略3: 10<x<14');\n\n        // 场景中最小值\n        let min = Math.min(8, this.getMinValue());\n\n        // 总共需要生成的数字数量\n        let totalCnt = Math.floor(Math.min(20, space * 0.6));\n        if (totalCnt === 0) totalCnt = 1;\n\n        // 最大值 9~11\n        const limitMax = Math.min(max - 1, 11);\n\n        // 生成数字的类型数量(既不能超过可生成的总数量，也不能超过当前允许出现的类型上限)\n        let typeCnt = totalCnt >= 3 ? 3 : totalCnt;\n        typeCnt = Math.min(typeCnt, limitMax - min + 1);\n\n        // 数字种类\n        const types = NewUtils.randomIntArrFromSection(typeCnt, min, limitMax);\n\n        // 生成全部的随机筹码值\n        let allNewCoin = NewUtils.randomIntArrFromArr(totalCnt, types);\n\n        // 确定当前的剩余空间情况\n        let spaceInfo = [];\n        for (let i = 0; i < 8; i++) {\n            const perSlotSpace = this.getSpaceBySlot(i);\n            spaceInfo.push(perSlotSpace);\n        }\n\n        // 随机将已经生成的数字填充到相应的空位置处(一定是可以放得下的，剩余空间>=生成的数字数量)\n        const result = [[], [], [], [], [], [], [], []];\n        do {\n            const slotIdx = NewUtils.randomIntInclusive(0, 7);\n            if (spaceInfo[slotIdx] === 0) continue;\n\n            result[slotIdx].push(allNewCoin.shift());\n            spaceInfo[slotIdx]--;\n        } while (allNewCoin.length > 0)\n\n        return result;\n    }\n\n    // 小于15的策略\n    produceStrategyFour(max: number, space: number): number[][] {\n        console.log('策略1:<15');\n\n        // 场景中最小值\n        let min = Math.min(11, this.getMinValue());\n\n        // 总共需要生成的数字数量\n        let totalCnt = Math.floor(Math.min(25, space * 0.8));\n        if (totalCnt === 0) totalCnt = 1;\n\n        // 最大值11~13\n        const limitMax = Math.min(max - 1, 11);\n\n        // 生成数字的类型数量 min~9\n        let typeCnt = totalCnt >= 3 ? 3 : totalCnt;\n\n        // 数字种类\n        const types = NewUtils.randomIntArrFromSection(typeCnt, min, limitMax);\n\n        // 生成全部的随机筹码值\n        let allNewCoin = NewUtils.randomIntArrFromArr(totalCnt, types);\n\n        // 确定当前的剩余空间情况\n        let spaceInfo = [];\n        for (let i = 0; i < 8; i++) {\n            const perSlotSpace = this.getSpaceBySlot(i);\n            spaceInfo.push(perSlotSpace);\n        }\n\n        // 随机将已经生成的数字填充到相应的空位置处(一定是可以放得下的，剩余空间>=生成的数字数量)\n        const result = [[], [], [], [], [], [], [], []];\n        do {\n            const slotIdx = NewUtils.randomIntInclusive(0, 7);\n            if (spaceInfo[slotIdx] === 0) continue;\n\n            result[slotIdx].push(allNewCoin.shift());\n            spaceInfo[slotIdx]--;\n        } while (allNewCoin.length > 0)\n\n        return result;\n    }\n\n    // TODO: 新生成的数据和原有数据进行合成\n    mergeProduceData(newData: number[][]): void {\n        for (let slotIdx = 0; slotIdx < 8; slotIdx++) {\n            const newSlotData = NewUtils.deepClone(newData[slotIdx]);\n            for (let j = 0; j < 10; j++) {\n                if (this.slotData[slotIdx][j] === 0 && newSlotData.length > 0) {\n                    const newCoinData = newSlotData.shift();\n                    this.slotData[slotIdx][j] = newCoinData;\n                }\n            }\n        }\n    }\n\n    /*\n     * TODO: 梳理棋盘数据(服务器逻辑)\n     * @description: 保留场景中最大的8个种类数，每种数最多保留10个，其余都扔掉\n     */\n    tidyData(): void {\n        // 1、记录每种类型数字的持有总数\n        const dataMap = {};\n        for (let i = 0; i < this.slotData.length; i++) {\n            for (let j = 0; j < 10; j++) {\n                if (this.slotData[i][j] !== 0) {\n                    if (dataMap[`${this.slotData[i][j]}`]) {\n                        dataMap[`${this.slotData[i][j]}`] += 1;\n                    } else {\n                        dataMap[`${this.slotData[i][j]}`] = 1;\n                    }\n                }\n            }\n        }\n        console.log('dataMap:', dataMap);\n\n        // 2、根据每种数字类型，创建一个长度为10的类型，数量不足10补足0\n        const allData: number[][] = [];\n        for (const key in dataMap) {\n            if (dataMap[key] > 10) {\n                dataMap[key] = 10;\n            }\n\n            const perTypeData = [];\n            for (let i = 0; i < 10; i++) {\n                if (i <= dataMap[key] - 1) {\n                    perTypeData.push(Number(key));\n                } else {\n                    perTypeData.push(0);\n                }\n            }\n\n            allData.push(perTypeData);\n        }\n\n        // 3、将所有类型的数组从大到小有序排列\n        allData.sort((a, b) => {\n            return b[0] - a[0];\n        });\n\n        // 最终标准格式化\n        if (allData.length > 8) {\n            // 类型超过8种 取前八\n            this.slotData = allData.slice(0, 7);\n        } else {\n            // 不足8种，补足8种\n            for (let i = 0; i < 8; i++) {\n                if (allData.length <= i) {\n                    allData.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);\n                }\n            }\n\n            this.slotData = allData;\n        }\n\n        console.log('整理后的slotData:', allData, this.slotData);\n    }\n}\nexport const gameModule = new GameModule();\n"]}