{"version":3,"sources":["assets/script/merge/game/Slot.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { gameModule } from '../dataModule/GameModule';\nimport { EventType } from '../manager/Define';\nimport { uimanager } from '../manager/Uimanager';\nimport { eventManager } from '../util/EventManager';\nimport Coin from './Coin';\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class Slot extends cc.Component {\n    // 当前筹码槽位的索引\n    idx: number = 0;\n    // 筹码的坐标位置\n    coinOriginalPos: number[][] = [\n        [58, 197],\n        [58, 178],\n        [58, 159.3],\n        [58, 140],\n        [58, 121],\n        [58, 102],\n        [58, 83],\n        [58, 64],\n        [58, 45],\n        [58, 26],\n    ];\n\n    @property(cc.Node)\n    coin0: cc.Node = null;\n\n    @property(cc.Node)\n    coin1: cc.Node = null;\n\n    @property(cc.Node)\n    coin2: cc.Node = null;\n\n    @property(cc.Node)\n    coin3: cc.Node = null;\n\n    @property(cc.Node)\n    coin4: cc.Node = null;\n\n    @property(cc.Node)\n    coin5: cc.Node = null;\n\n    @property(cc.Node)\n    coin6: cc.Node = null;\n\n    @property(cc.Node)\n    coin7: cc.Node = null;\n\n    @property(cc.Node)\n    coin8: cc.Node = null;\n\n    @property(cc.Node)\n    coin9: cc.Node = null;\n\n    @property(cc.Node)\n    uImgSlotSelect: cc.Node = null;\n\n    @property(cc.Node)\n    uImgSlotMerge: cc.Node = null;\n\n    onLoad() {\n        // 添加点击事件\n        this.node.on(cc.Node.EventType.TOUCH_END, this.selectAction, this);\n        eventManager.on(EventType.MOVE_COIN, this.onMove, this);\n        eventManager.on(EventType.MOVE_END, this.onMoveEnd, this);\n        eventManager.on(EventType.CHECK_MERGE, this.onUpdateMergeStatus, this);\n        eventManager.on(EventType.MERGE_COIN, this.onMerge, this);\n    }\n\n    start() {\n    }\n\n    formatData(idx: number, data: number[]): void {\n        this.idx = idx;\n\n        for (let i = 0; i < 10; i++) {\n            // data\n            if (data[i] !== 0) {\n                this[`coin${i}`].active = true;\n                this[`coin${i}`].getComponent(Coin).init(this.idx, data[i]);\n            } else {\n                this[`coin${i}`].active = false;\n            }\n\n            // pos\n            this[`coin${i}`].setPosition(cc.v2(this.coinOriginalPos[i][0], this.coinOriginalPos[i][1]))\n        }\n\n        this.node.setSiblingIndex(this.idx);\n    }\n\n    // 选择行为\n    selectAction() {\n        if (gameModule.curSelectSlotIdx === -1) {\n            // 初次选择行为\n            this.onSelect();\n        } else if (gameModule.curSelectSlotIdx === this.idx) {\n            // 取消选择行为\n            this.onDeSelect();\n        } else {\n            // 移动行为 当前节点为目标节点\n            this.onCheckMove();\n        }\n    }\n\n    // 选中当前槽位\n    onSelect(): void {\n        const slotData = gameModule.slotData[this.idx];\n\n        // 选中了空的槽位\n        if (slotData[0] === 0) {\n            console.log('选中了空的槽位');\n            return;\n        }\n\n        // 合并效果中，不可选中\n        if (gameModule.mergeLock) {\n            console.log('正在合并中，无法选中');\n            return;\n        }\n\n        gameModule.curSelectSlotIdx = this.idx;\n        this.uImgSlotSelect.active = true;\n        this.node.setSiblingIndex(8);\n\n        // 挑选待操作筹码的索引\n        gameModule.curSelectCoinIdxs = [];\n        for (let i = 9; i >= 0; i--) {\n            if (slotData[i] === 0) continue;\n\n            if (gameModule.curSelectCoinIdxs.length === 0) {\n                gameModule.curSelectCoinIdxs.push(i);\n            } else if (slotData[i] === slotData[gameModule.curSelectCoinIdxs[gameModule.curSelectCoinIdxs.length - 1]]) {\n                gameModule.curSelectCoinIdxs.push(i);\n            } else {\n                break;\n            }\n        }\n\n        console.log(`选中了第${this.idx}个槽的`, gameModule.curSelectCoinIdxs);\n\n        // 对待操作筹码的显示效果进行展示\n        for (let i = 0; i < gameModule.curSelectCoinIdxs.length; i++) {\n            const tarPosY = this.coinOriginalPos[gameModule.curSelectCoinIdxs[i]][1] + 25;\n            cc.tween(this[`coin${gameModule.curSelectCoinIdxs[i]}`])\n                .to(0.5, { y: tarPosY }, { easing: 'backOut' })\n                .start()\n        }\n    }\n\n    // 取消选中\n    onDeSelect(): void {\n        console.log('取消选择');\n        for (let i = 0; i < 10; i++) {\n            // data\n            const tarPosY = this.coinOriginalPos[i][1];\n            cc.tween(this[`coin${i}`])\n                .to(0.5, { y: tarPosY }, { easing: 'backOut' })\n                .start()\n        }\n\n        this.uImgSlotSelect.active = false;\n\n        gameModule.curSelectSlotIdx = -1;\n    }\n\n    // 移动\n    onCheckMove(): void {\n        // 如果当前槽位已满则不允许移动\n        if (gameModule.slotData[this.idx].indexOf(0) === -1) {\n            console.log('筹码数量已满，不可移动');\n            return;\n        }\n\n        // 如果当前槽位最近的筹码与当前选中的待移动筹码类型不一致 不允许移动\n        const curSlotInfo = gameModule.getFirstVaildNumBySlotIdx(this.idx);\n        const curSelectCoinInfo = gameModule.getCurSelectSlotInfo();\n        if (curSlotInfo.vaildNum !== -1 && curSlotInfo.vaildNum !== curSelectCoinInfo.num) {\n            console.log('筹码类型不一致, 不可移动');\n            return;\n        }\n\n        if (gameModule.moveLock) {\n            console.log('正在移动中，无法产生更多移动');\n            return;\n        }\n\n        // 确定可以移动的筹码数量\n        const moveCnt = Math.min(curSlotInfo.vaildSpace, curSelectCoinInfo.cnt);\n\n        // 确定移动到的目标位置\n        const tarPos: cc.Vec2[] = [];\n\n        // 目标槽位发生数据变动的位置索引集\n        const tarIdxArr: number[] = [];\n        // 原槽位发生数据变动的槽位索引集\n        const srcIdxArr: number[] = [];\n\n        let startPosIdx: number = curSlotInfo.vaildIdx + 1;\n        for (let i = 0; i < moveCnt; i++) {\n            const oriPosX = this.coinOriginalPos[startPosIdx][0];\n            const oriPosY = this.coinOriginalPos[startPosIdx][1];\n            const globalPos = this.node.convertToWorldSpaceAR(cc.v2(oriPosX, oriPosY));\n            tarPos.push(globalPos);\n            tarIdxArr.push(startPosIdx);\n            srcIdxArr.push(gameModule.curSelectCoinIdxs[i]);\n            startPosIdx++;\n        }\n\n        // 通知待移动的槽位进行筹码移动\n        const eventData = {\n            // 实际移动数量\n            moveCnt,\n            // 目标移动的节点对应位置(低->高)\n            tarPos,\n            // 目标槽位实际发生数据变动的筹码索引集(低->低)\n            tarIdxArr,\n            // 原槽位实际发生移动的筹码索引集(高->低)\n            srcIdxArr,\n            // 实际发生的筹码类型\n            numType: curSelectCoinInfo.num,\n            // 目标槽位索引\n            tarSlotIdx: this.idx,\n        }\n        eventManager.dispatch(EventType.MOVE_COIN, eventData);\n    }\n\n    // 开始进行移动\n    onMove(e) {\n        const eventData = e.data;\n        if (this.idx !== gameModule.curSelectSlotIdx) return;\n        console.log(`onMove: ${gameModule.curSelectSlotIdx} -> ${eventData.tarSlotIdx}`);\n\n        gameModule.moveLock = true;\n\n        const moveCnt = eventData.moveCnt;\n        const tarWorldPos: cc.Vec2[] = eventData.tarPos;\n        const tarLocalPos: cc.Vec2[] = [];\n        for (let i = tarWorldPos.length - 1; i >= 0; i--) {\n            tarLocalPos.push(this.node.convertToNodeSpaceAR(tarWorldPos[i]));\n        }\n\n        // 由高到低的进行移动\n        let startIdx = gameModule.curSelectCoinIdxs[0];\n        for (let i = 0; i < moveCnt; i++) {\n            cc.tween(this[`coin${startIdx}`])\n                .delay(0.02 * i)\n                .to(0.05, { position: tarLocalPos[i] })\n                .call(() => {\n                    if (i === moveCnt - 1) {\n                        gameModule.tidySlotData({\n                            tarSlotIdx: eventData.tarSlotIdx,\n                            numType: eventData.numType,\n                            srcIdxArr: eventData.srcIdxArr,\n                            tarIdxArr: eventData.tarIdxArr,\n                        });\n                        this.onDeSelect();\n                        gameModule.moveLock = false;\n                    }\n                })\n                .start()\n\n            startIdx--;\n        }\n    }\n\n    onMoveEnd() {\n        console.log('onMoveEnd');\n        this.formatData(this.idx, gameModule.slotData[this.idx]);\n    }\n\n    // 刷新合成状态\n    onUpdateMergeStatus(): void {\n        const canMerge = gameModule.checkCanMergeBySlot(this.idx);\n        this.uImgSlotMerge.active = canMerge;\n        this.showMergeHintAction(canMerge);\n    }\n\n    // 提示合成\n    showMergeHintAction(canMerge: boolean): void {\n        if (canMerge) {\n            this.uImgSlotMerge.opacity = 0;\n            cc.tween(this.uImgSlotMerge)\n                .to(1, { opacity: 255 })\n                .to(1, { opacity: 0 })\n                .call(() => { this.showMergeHintAction(canMerge) })\n                .start();\n        } else {\n            // cc.tween(this.uImgSlotMerge).stop();\n        }\n    }\n\n    // 合成\n    onMerge(): void {\n        const canMerge = gameModule.checkCanMergeBySlot(this.idx);\n        if (!canMerge) return;\n\n        gameModule.mergeLock += 1;\n\n        // 合成效果\n        for (let i = 9; i >= 0; i--) {\n            cc.tween(this[`coin${i}`])\n                .delay(0.05 * (9 - i))\n                .to(0.1, { scale: 0 })\n                .call(() => {\n                    this[`coin${i}`].active = false;\n                    this[`coin${i}`].scale = 1;\n                    if (i === 0) { this.onMergeFinish(); }\n                })\n                .start();\n        }\n    }\n\n    // 合成结束\n    onMergeFinish(): void {\n        // 合成目标值\n        const mergeTargetValue = gameModule.slotData[this.idx][0] + 1;\n\n        // 合成后的数据\n        gameModule.slotData[this.idx] = [mergeTargetValue, mergeTargetValue, 0, 0, 0, 0, 0, 0, 0, 0];\n\n        console.log(`槽${this.idx} 合成${mergeTargetValue}`);\n\n        gameModule.mergeLock -= 1;\n        this.coin0.scale = 0;\n        this.coin1.scale = 0;\n        this.coin0.active = true;\n        this.coin1.active = true;\n        this.coin0.getComponent(Coin).init(this.idx, mergeTargetValue);\n        this.coin1.getComponent(Coin).init(this.idx, mergeTargetValue);\n\n        cc.tween(this.coin0)\n            .to(0.5, { scale: 1 }, { easing: 'backOut' })\n            .start();\n        cc.tween(this.coin1)\n            .to(0.5, { scale: 1 }, { easing: 'backOut' })\n            .start();\n\n        this.uImgSlotMerge.active = false;\n    }\n\n    // 生成筹码\n    async produce(newCoin: number[], startGlobalPos: cc.Vec2) {\n        console.log(this.idx, newCoin);\n        // 不需要生成就不操作了\n        if (newCoin.length === 0) return;\n\n        // 需要生成的起始位置\n        let startPosIdx: number = 0;\n        for (let i = 0; i < 10; i++) {\n            if (gameModule.slotData[this.idx][i] === 0) {\n                startPosIdx = i;\n                break;\n            }\n        }\n\n        // 派发筹码效果的起始位置\n        const localPosSrc = this.node.convertToNodeSpaceAR(startGlobalPos);\n        // 已经生成的筹码数量\n        let producedCnt = 0;\n        for (let i = 0; i < newCoin.length; i++) {\n            // 生成一个表现用的新筹码\n            const newCoinNode = await this.produceCoin();\n            const node = newCoinNode.getComponent(Coin).node;\n            this.node.addChild(newCoinNode);\n            node.setPosition(localPosSrc);\n\n            // // 确定要飞的目的地坐标\n            // const tarPos = this.coinOriginalPos[startPosIdx + producedCnt];\n            \n            producedCnt++;\n        }\n    }\n\n    async produceCoin():Promise<cc.Node> {\n        const coinPrefab = await uimanager.loadPrefab('prefab/merge/coin');\n        const coin = cc.instantiate(coinPrefab);\n        return coin;\n    }\n\n    // update (dt) {}\n}\n"]}