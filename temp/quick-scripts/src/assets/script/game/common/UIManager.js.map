{"version":3,"sources":["assets/script/game/common/UIManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import HurryLoading from \"../../common/comp/HurryLoading\";\nimport PanelBase from \"../../common/comp/PanelBase\";\nimport { GlobalDefines } from \"../../common/consts/GlobalDefines\";\nimport { Logger } from \"../../utils/logger\";\nimport { Utils } from \"../../utils/Utils\";\n\n\nexport enum UILayer {\n    Topres = 0,\n    Panel,\n    LoadingBar,\n    MessageBox,\n    Guide,\n    Banner,\n    X,\n    Tip,\n    Effect,\n    Effect2,\n}\n\nexport default class UIManager {\n    private static _ins: UIManager;\n    public static get ins() {\n        if (!this._ins) {\n            this._ins = new UIManager();\n        }\n        return this._ins;\n    }\n\n    private node: cc.Node;\n    private alert: cc.Node;\n\n    hurryLoading: HurryLoading = null;\n\n    private constructor() { }\n\n    public onLoad(node: cc.Node, hurryLoading: HurryLoading) {\n        this.node = node;\n        this.hurryLoading = hurryLoading;\n    }\n\n    onInit() {\n        this.hideLoading();\n    }\n\n    /**\n     * 显示加载菊花\n     * @param title \n     */\n    public showLoading(title?: string) {\n        this.hurryLoading.show();\n    }\n    /**\n     * 隐藏加载菊花\n     * @param title \n     */\n    public hideLoading() {\n        this.hurryLoading.hide();\n    }\n\n    /**\n     * 在场景中构建UI结构\n     */\n    public checkNode() {\n        Logger.warn(\"[UIManager checkNode] width:\", this.node.width, \"/height:\", this.node.height);\n\n        for (var key in UILayer) {\n            var keyToAny: any = key;\n            //判断是否是数字\n            if (isNaN(keyToAny)) {\n                this.addNullNode(this.node, key);\n            }\n        }\n    }\n\n    private addNullNode(baseNode: cc.Node, nodeName: string): cc.Node {\n        if (!baseNode) {\n            console.warn(`[UIManager addNullNode] ${baseNode}不存在`);\n            return undefined;\n        }\n        let node = baseNode.getChildByName(nodeName);\n        if (!!node) {\n            console.warn(`[UIManager addNullNode] 节点${nodeName}已经存在`);\n            return node;\n        }\n        let newNode = new cc.Node(nodeName);\n        baseNode.addChild(newNode);\n        newNode.width = newNode.parent.width;\n        newNode.height = newNode.parent.height;\n        newNode.x = 0;\n        newNode.y = 0;\n        return newNode;\n    }\n\n    getLayer(layerId: UILayer): cc.Node {\n        let name = UILayer[layerId];\n        let node = this.node.getChildByName(name);\n        return node;\n    }\n\n    public addGuide(view: cc.Node) {\n        view.x = 0;\n        view.y = 0;\n        view.width = GlobalDefines.ScreenWidth;\n        view.height = GlobalDefines.ScreenHeight;\n        this.getLayer(UILayer.Guide).addChild(view);\n    }\n\n    public popView(view: cc.Node, insert: boolean = false) {\n        view.x = 0;\n        view.y = 0;\n        view.width = GlobalDefines.ScreenWidth;\n        view.height = GlobalDefines.ScreenHeight;\n        if (insert) {\n            this.getLayer(UILayer.Panel).insertChild(view, 0);\n        } else {\n            view.parent = this.getLayer(UILayer.Panel);\n        }\n    }\n\n\n    public tip(node: cc.Node) {\n        node.parent = this.getLayer(UILayer.Tip)\n    }\n\n    public layerClear(layerId: UILayer) {\n        Utils.removeAllChildren(this.getLayer(layerId));\n    }\n\n    public addEffect(effect: cc.Node) {\n        if (this.getLayer(UILayer.Effect).childrenCount >= 200) {\n            Utils.removeNode(this.getLayer(UILayer.Effect).children[0]);\n        }\n        effect.parent = this.getLayer(UILayer.Effect);\n    }\n\n    /**\n     * 约定effect.postion为worldAR座标\n     * @param effectByWorldAR \n     */\n    public addEffectAR(effectByWorldAR: cc.Node) {\n        let posOfEffect = this.getLayer(UILayer.Effect).convertToNodeSpaceAR(effectByWorldAR.position);\n        effectByWorldAR.position = posOfEffect;\n        this.addEffect(effectByWorldAR);\n    }\n\n    public onSwitchScene() {\n        PanelBase.onSwitchScene();\n        this.layerClear(UILayer.Panel);\n        this.layerClear(UILayer.Tip);\n    }\n\n    public get safeAreaTop() {\n        return GlobalDefines.MenuButtonLogic.top + GlobalDefines.MenuButtonLogic.height + (100 - GlobalDefines.MenuButtonLogic.height) / 2;\n    }\n\n    alignmentToMenu(node: cc.Node) {\n        let menuTop = GlobalDefines.MenuButtonLogic.top;\n        let menuHeight = GlobalDefines.MenuButtonLogic.height;\n        let screenHeight = GlobalDefines.ScreenHeight;\n        node.y = screenHeight / 2 - menuTop - menuHeight / 2;//中心与胶囊中心对齐   \n        Logger.debug(\"[BattleOptionWord alignmentToMenu] bar.y:\", node.y, \"ScreenHeight:\", GlobalDefines.ScreenHeight);\n    }\n}\nexport const ui = UIManager.ins;"]}