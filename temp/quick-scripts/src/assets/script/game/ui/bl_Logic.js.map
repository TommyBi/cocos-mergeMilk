{"version":3,"sources":["assets/script/game/ui/bl_Logic.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { Utils } from \"../../utils/Utils\";\nimport { dm } from \"../../common/DataManager\";\nimport { GlobalDefines } from \"../../common/consts/GlobalDefines\";\nimport bl_ball from \"./bl_ball\";\nimport { GlobalEvent } from \"../../common/Global\";\nimport { EventBallClick, EventChangeTop } from \"../../common/GlobalEvents\";\nimport { Logger } from \"../../utils/logger\";\nimport { bc } from \"./bl_Config\";\nimport bl_tipsPanel from \"./bl_tipsPanel\";\nimport { RewardUtils } from \"../../common/comp/reward/RewardUtils\";\nimport { sm } from \"../../common/SceneManager\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class bl_Logic extends cc.Component {\n\n    @property(cc.Node)\n    ico: cc.Node = null;\n\n    bl_list = [];\n\n    bl_dropXs = [];\n\n    bl_cloneDropx = [];\n\n    bl_scList: bl_ball[] = [];\n\n    isComposeIng = false;\n    onLoad() {\n        this.bl_dropXs = this.bl_initDropX(-this.node.width / 2 + 200, this.node.width / 2 - 200, 10);\n    }\n\n    onEnable() {\n        GlobalEvent.on(EventBallClick.NAME, this.onEventBallClick, this);\n    }\n    onDisable() {\n        GlobalEvent.off(EventBallClick.NAME, this.onEventBallClick, this);\n    }\n\n\n    start() {\n\n    }\n    async init() {\n        this.bl_list = dm.player.arr;\n        Utils.arrayCopy(this.bl_dropXs, this.bl_cloneDropx);\n        for (let i = 0; i < this.bl_list.length; i++) {\n            let point = this.bl_getPoint(this.bl_list[i]);\n            let node = await this.bl_createBall(this.bl_list[i], point, true);\n            let scr = node.getComponent(bl_ball)\n            this.bl_scList.push(scr);\n        }\n    }\n\n\n    //获得筹码预制件\n    async bl_createBall(idx, point, isDrop?) {\n        let url = 'prefab/game/ball/' + idx;\n        let p = await Utils.loadPefab(url);\n        let b: cc.Node = cc.instantiate(p);\n        b.parent = this.node;\n        let scr = b.getComponent(bl_ball)\n        // this.bl_scList.push(scr);\n        scr.init(idx, isDrop);\n        b.setPosition(point);\n\n        return b;\n    }\n\n    bl_getPoint(idx) {\n        let y = GlobalDefines.ScreenHeight / 2;\n        y += Math.random() * 200 * idx;\n        let x = Utils.getRandomByArr(this.bl_cloneDropx);\n        return cc.v2(x, y);\n    }\n\n    bl_initDropX(min, max, count) {\n        const totalRange = max - min + 1;\n        const averageSpace = totalRange / count; // 每个点应该占据的平均空间  \n        // const remainder = totalRange % count; // 无法均匀分配的余数  \n\n        let points = [];\n        let currentPoint = min;\n\n        // 首先分配完整的平均空间  \n        for (let i = 0; i < count; i++) {\n            points.push(currentPoint);\n            currentPoint += averageSpace;\n        }\n\n        let arr1 = points.filter(value => value >= 0);\n        let arr2 = points.filter(value => value < 0);\n\n        arr1.sort((a, b) => a - b);\n        arr2.sort((a, b) => b - a);\n\n        points = arr1.concat(arr2);\n\n        return points;\n    }\n\n    currBalls: bl_ball[] = [];\n    currTarget: bl_ball;\n    onEventBallClick(evt: EventBallClick) {\n        if (this.isComposeIng) return;\n        let arr = this.bl_scList.filter((value) => {\n            return value.rId == evt.rId;\n        })\n        if (arr.length > 0) {\n            this.currBalls = this.bl_scList.filter((value) => {\n                return value.id == evt.id;\n            })\n            this.currTarget = arr[0];\n            let alls = this.bl_findBall();\n            if (alls.size == 0) return;\n            let arr1 = Array.from(alls);\n            arr1.sort((a, b) => {\n                let d1 = Utils.distanceByNode(this.currTarget.node, a.node)\n                let d2 = Utils.distanceByNode(this.currTarget.node, b.node)\n                return d1 - d2;\n            })\n            arr1.unshift(this.currTarget);\n            this.bl_compose(arr1)\n            Logger.debug(\"合成：\", arr1);\n        }\n    }\n\n    async bl_compose(arr: bl_ball[]) {\n        this.isComposeIng = true;\n        // let targets: bl_ball[] = arr.filter((value, index) => {\n        //     return index % 2 == 0;\n        // })\n        let targets = [];\n        let deletes = [];\n        arr.forEach((element, index) => {\n            if (index % 2 == 0 && index != arr.length - 1) {\n                targets.push(element);\n            } else {\n                deletes.push(element);\n            }\n        });\n\n        for (let i = 0; i < deletes.length; i++) {\n            deletes[i].delete();\n        }\n        deletes = null;\n        // if (targets.length % 2 == 0) {\n        //     let needDelete = targets[targets.length - 1];\n        //     targets.splice(targets.length - 1, 1);\n        //     needDelete.delete();\n        //     targets.unshift(this.currTarget);\n        // }\n        this.bl_resetBallList();\n        let newList = [];\n        for (let i = 0; i < targets.length; i++) {\n            let node: cc.Node = targets[i].node\n            if (node) node.removeComponent(cc.RigidBody);\n            let point = targets[i].node.getPosition();\n            // this.bl_createBall(targets[i].id * 2, point);\n\n            let newNode = await this.bl_createBall(targets[i].id + 1, point);\n            let scr = newNode.getComponent(bl_ball);\n            this.bl_scList.push(scr);\n            newNode.scale = 0;\n            newList.push(scr);\n        }\n\n        let num = 0;\n        for (let i = 0; i < targets.length; i++) {\n            targets[i].playHide(() => {\n                num++;\n                if (num >= targets.length) {\n                    for (let i = 0; i < newList.length; i++) {\n                        newList[i].playShow();\n                    }\n                    targets = null;\n\n\n                    this.scheduleOnce(() => {\n                        this.bl_resetBallList();\n\n                        if (newList[0].id == bc.maxId) {\n                            for (let i = 0; i < newList.length; i++) {\n                                let best = newList[i];\n                                best.removeRigidbody();\n                                this.flyBest(best.node);\n                            }\n                        } else {\n                            if (newList.length > 1) {\n                                this.bl_compose(newList);\n                            } else {\n                                bl_tipsPanel.Show(21);\n                                this.flyIco();\n                                this.isComposeIng = false;\n                                this.bl_drop();\n                                this.bl_cacheList();\n                            }\n                        }\n                    }, .2)\n                }\n            });\n        }\n\n    }\n\n    bl_cacheList() {\n        let arr = [];\n        for (let i = 0; i < this.bl_scList.length; i++) {\n            arr.push(this.bl_scList[i].id);\n        }\n        dm.player.arr = arr;\n    }\n\n    bl_resetBallList() {\n        this.currBalls = [];\n        let arr = this.bl_scList.filter((value) => {\n            return value && !value.isDestory;\n        })\n        this.bl_scList = arr;\n    }\n\n    bl_findBall() {\n        let nearbyPoints = this.bl_getCanBall(this.currTarget);\n        let visitedPoints = new Set(nearbyPoints); // 使用Set来存储已访问的点  \n\n        // 迭代查询  \n        while (nearbyPoints.length > 0) {\n            let newNearbyPoints = [];\n            for (let ball of nearbyPoints) {\n                // 查询距离当前点为5个单位内的点，但排除已访问过的点  \n                let tempNearbyPoints = this.bl_getCanBall(ball);\n                for (let tempPoint of tempNearbyPoints) {\n                    if (!visitedPoints.has(tempPoint)) {\n                        newNearbyPoints.push(tempPoint);\n                        visitedPoints.add(tempPoint);\n                    }\n                }\n            }\n            nearbyPoints = newNearbyPoints; // 更新需要查询的点  \n        }\n\n        // 返回所有找到的点（包括初始查询和迭代查询的结果）  \n        return visitedPoints;\n    }\n\n    bl_getCanBall(target) {\n        let arr = this.currBalls.filter((value) => {\n            let dis = Utils.distanceByNode(target.node, value.node);\n            return dis < target.node.width + 20 && value.rId != this.currTarget.rId;\n        })\n        return arr;\n    }\n\n    async bl_drop() {\n\n        let maxY = this.bl_checkMaxPointY();\n        if (maxY > this.node.height / 2 - 200) return;\n        if (maxY > this.node.height / 4) {\n            let random = Utils.randomFloat(0, 1);\n            if (random < .5) return;\n        }\n        let len = Utils.randomInt(1, 15)\n        if (maxY > this.node.height / 4 + 100) {\n            len = Utils.randomInt(1, 10)\n        }\n\n\n        let maxId = this.bl_checkMaxId();\n        maxId = maxId > 3 ? 3 : maxId;\n\n        let typeNum = Utils.randomIntInclusive(1, maxId);\n        let rates = Utils.getRandomRates(typeNum);\n        let ids = [];\n        for (let i = 1; i <= typeNum; i++) {\n            ids.push(i);\n        }\n        for (let i = 0; i < len; i++) {\n            let index = Utils.randomByWeightList(rates);\n            let id = ids[index];\n            let point = this.bl_getPoint(id);\n            let node = await this.bl_createBall(id, point, true);\n            let scr = node.getComponent(bl_ball)\n            this.bl_scList.push(scr);\n        }\n        this.bl_cacheList();\n    }\n    //检测当前最大值\n    bl_checkMaxId() {\n        let flag = 0;\n        this.bl_scList.forEach((element) => {\n            if (element.id > flag) flag = element.id;\n        })\n        return flag;\n    }\n\n    bl_checkMaxPointY() {\n        let flag = 0;\n        this.bl_scList.forEach((element) => {\n            if (element.node.y > flag) flag = element.node.y;\n        })\n        return flag;\n    }\n\n    //刷新\n    bl_onRefresh() {\n        if (Utils.btnLock()) {\n            return;\n        }\n\n        this.node.destroyAllChildren();\n        this.bl_scList = [];\n        this.init();\n\n    }\n\n    flyIco() {\n        let target = bc.top.ico2;\n        RewardUtils.resBoomByNode(this.ico, target, 10);\n\n    }\n\n    flyBest(node) {\n        let target = bc.top.ico1;\n        let p1 = target.convertToWorldSpaceAR(cc.v2(0, 0));\n        let p2 = this.node.convertToNodeSpaceAR(p1);\n        cc.tween(node).to(.2, { x: 0, y: 0, scale: 1.1 }).delay(1).to(.5, { position: p2, scale: .5 }, cc.easeSineIn()).to(.2, { scale: 0 }, cc.easeSineIn()).call(() => {\n            GlobalEvent.dispatchEvent(new EventChangeTop(2, 1));\n        }).start();\n\n    }\n\n\n\n}\n"]}