{"version":3,"sources":["assets/script/common/effect/Jumpjump3d.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { GameUtils } from \"../../game/GameUtils\";\nimport { Utils } from \"../../utils/Utils\";\nimport Ball_Main from \"../Ball_Main\";\nimport { GlobalEvent } from \"../Global\";\n\n/*\n* 飞抵最终目的地\n*/\nexport class EventOnBoom extends cc.Event.EventCustom {\n    public static readonly NAME: string = \"EventOnBoom\";\n    public tType: number;\n    public constructor(tType: number) {\n        super(EventOnBoom.NAME, true);\n        this.tType = tType;\n    }\n}\n\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class Jumpjump3d extends cc.Component {\n    public static async createBySpr(shadowFrame: cc.SpriteFrame, spriteFrame: cc.SpriteFrame, startWorldPos: cc.Vec2, groundLine: number, scale: number, tWPos?: cc.Vec2, tType?: number) {\n        let icon = new cc.Node();\n        let sprite = icon.addComponent(cc.Sprite);\n        sprite.sizeMode = cc.Sprite.SizeMode.RAW;\n        sprite.spriteFrame = spriteFrame;\n        sprite.node.y = sprite.node.height / 2;//下边缘对齐\n\n        this._create(shadowFrame, icon, startWorldPos, groundLine, scale, tWPos, tType);\n    }\n\n    public static async createByStr(shadowFrame: cc.SpriteFrame, str: string, startWorldPos: cc.Vec2, groundLine: number, scale: number, tWPos?: cc.Vec2, tType?: number) {\n        let icon = new cc.Node();\n        icon.color = cc.color(249, 229, 114, 255);\n        let lb = icon.addComponent(cc.Label);\n        lb.fontSize = 40;\n        lb.enableBold = true;\n        lb.string = str;\n        // lb.node.y = lb.node.height / 2;//下边缘对齐\n\n        this._create(shadowFrame, icon, startWorldPos, groundLine, scale, tWPos, tType);\n    }\n\n    private static async _create(shadowFrame: cc.SpriteFrame, nodeActor: cc.Node, startWorldPos: cc.Vec2, groundLine: number, scale: number, tWPos?: cc.Vec2, tType?: number) {\n        let node = new cc.Node();\n\n        let shadow = new cc.Node();\n        shadow.y = groundLine;\n        shadow.scaleY = 0.2;\n        shadow.scaleX = 0.3\n        shadow.color = cc.Color.BLACK;\n        let spr = shadow.addComponent(cc.Sprite);\n        if (shadowFrame) {\n            spr.spriteFrame = shadowFrame;\n            shadow.opacity = 90;\n        } else {\n            shadow.opacity = 0;\n        }\n        node.addChild(shadow);\n\n        node.addChild(nodeActor);\n\n        let script: Jumpjump3d = node.addComponent(Jumpjump3d);\n        node.position = startWorldPos;\n        script.groundLine = groundLine;\n        script.scale = scale == undefined ? Utils.randomFloat(0.8, 1.2) : scale;\n        script.tWPos = tWPos;\n        script.tType = tType;\n        GameUtils.addEffectAR(node);\n    }\n\n    dx: number = 0;\n    dy: number = 0;\n    dz: number = 170;\n    rate: number = 0.45;\n    groundLine: number = 0;\n    scale: number = 1;\n\n    icon: cc.Node = null;\n\n    isFading: boolean = false;\n\n    curStatus: number = 0;\n    nextStatus: number = 0;\n    tWPos: cc.Vec2 = undefined;\n    tType: number;\n\n    onLoad() {\n        this.dz = Utils.randomIntInclusive(this.dz / 2, this.dz);\n        let dr = this.dz / this.rate;\n        this.dx = Utils.randomIntInclusive(-dr, dr);\n        this.dy = Utils.randomIntInclusive(-dr, dr) * 0.6;\n        this.node.scale = this.scale;\n        this.icon = this.node.children[1];\n        let delayTime = Utils.randomFloat(0.15, 0.25);\n        let duration = Utils.randomFloat(0.2, 0.4);\n        cc.tween(this.node)\n            .by(duration, { x: this.dx, y: this.dy }, { easing: cc.easing.sineOut })\n            .delay(delayTime)\n            .call(() => {\n                if (!!this.tWPos) {\n                    //飞向金猪                    \n                    let tNPos = this.node.parent.convertToNodeSpaceAR(this.tWPos);\n                    let scale = this.node.scale;\n                    cc.tween(this.node)\n                        .delay(0.3)\n                        .to(0.4, { position: tNPos, scale: scale * 0.8 })\n                        .call(() => {\n                            GameUtils.playFlyCoin();\n                            GlobalEvent.dispatchEvent(new EventOnBoom(this.tType));\n                            this.close();\n                        })\n                        .start();\n                } else {\n                    //消失\n                    cc.tween(this.node)\n                        .to(0.15, { opacity: 0 })\n                        .call(() => {\n                            this.close();\n                        })\n                        .start();\n                }\n            })\n            .start();\n        // this.jump(duration, this.dx > 0 ? 1 : -1);\n    }\n    jump(duration: number, dir: number) {\n        let durationJump = Utils.randomFloat(0.13, 0.19);\n        let durationSlide = Math.max(0, duration - durationJump * 2);\n        cc.tween(this.icon)\n            .to(durationJump, { y: this.dz, angle: 95 * dir, scale: 1.5 }, { easing: cc.easing.sineOut })\n            .to(durationJump, { y: this.groundLine, angle: 185 * dir, scale: 1.3 }, { easing: cc.easing.sineIn })\n            .to(durationSlide, { angle: 0 }, { easing: cc.easing.sineOut })\n            .start();\n    }\n\n    close() {\n        Utils.removeNode(this.node);\n    }\n\n\n\n    // update() {\n    //     if (this.nextStatus != -1) {\n    //         this.curStatus = this.nextStatus;\n    //         this.nextStatus = -1;\n    //         switch (this.curStatus) {\n    //             case 0: {\n    //                 this.spdx = Utils.randomIntInclusive(-this.spdx, this.spdx);\n    //                 this.spdy = Utils.randomIntInclusive(0, this.spdy);\n    //                 break;\n    //             }\n    //             // case 1: {\n    //             //     this.node.y = this.groundLine;\n    //             //     this.spdy = Math.abs(this.spdy) * Utils.randomFloat(0.4, 0.6);\n    //             //     break;\n    //             // }\n    //             case 2: {\n    //                 this.close();\n    //                 break;\n    //             }\n    //         }\n    //     }\n    //     switch (this.curStatus) {\n    //         case 0: {\n    //             if (this.node.y < this.groundLine) {\n    //                 this.nextStatus = 1;\n    //             }\n    //             this.spdy -= .5;\n    //             this.node.x += this.spdx;\n    //             this.node.y += this.spdy;\n    //             this.icon.y += this.spdz;\n    //             break;\n    //         }\n    //         // case 1: {\n    //         //     if (this.node.y < -Ball_Main.instance.uiManager.ScreenHeight / 2) {\n    //         //         this.nextStatus = 2;\n    //         //     }\n    //         //     this.spdy -= .5;\n    //         //     this.node.x += this.spdx;\n    //         //     this.node.y += this.spdy;\n    //         //     break;\n    //         // }\n    //     }\n    // }\n}\n"]}