{"version":3,"sources":["assets/script/common/comp/toast/Toast.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\nconst { ccclass, property } = cc._decorator;\n\nexport enum TipIco {\n    NetErr = 0,\n    Error,\n    Tip,\n    Flower,\n    Coin,\n}\n\n@ccclass\nexport default class Toast extends cc.Component {\n    public static Prefab_Name = \"prefab/common/toast/toast\";\n    public static prefab: any = null;\n    public static async preLoad() {\n        Toast.prefab = await Toast.loadPefab(Toast.Prefab_Name).catch(err => {\n            throw err;\n        });\n    }\n\n    public static showNum(tipLayer: cc.Node, title: string, ico: TipIco, num: string) {\n        this._show(tipLayer, title, ico, num + \"\");\n    }\n\n    public static show(tipLayer: cc.Node, msg: string, ico: TipIco = TipIco.Tip) {\n        this._show(tipLayer, msg, ico, undefined, 2);\n    }\n    /**\n     * \n     * @param duration 秒\n     */\n    public static async _show(tipLayer: cc.Node, msg: string, iconIndex: number, num?: string, duration: number = 2) {\n        if (!this.prefab) {\n            await this.preLoad();\n        }\n        let instance: cc.Node = cc.instantiate(Toast.prefab);\n        let t: Toast = instance.getComponent(Toast);\n        t._show(msg, iconIndex, num, duration);\n        instance.parent = tipLayer;\n        return instance;\n    }\n    /**\n     * 预制件加载\n     * @param path \n     */\n    static async loadPefab(path: string, needRelease: boolean = false): Promise<any> {\n        return new Promise(async (resolve, reject) => {\n            // if (this.prefab_need_release[path]) {\n            //     resolve(this.prefab_need_release[path]);\n            //     return;\n            // }\n            let load = async () => {\n                return new Promise((rsv, rjt) => {\n                    var tot = setTimeout(() => {\n                        rjt(\"oadPefab 连接超时\" + path);\n                    }, 10000);\n                    cc.resources.load(path, (err, res) => {\n                        clearTimeout(tot);\n\n                        if (err) {\n                            rjt(err);\n                        } else {\n                            rsv(res);\n                        }\n                    });\n                });\n            }\n\n            let times = 3;\n            while (times > 0) {\n                await load().then((res) => {\n                    times = 0;\n                    // if (needRelease) {\n                    //     this.prefab_need_release[path] = res;\n                    // }\n                    resolve(res);\n                }).catch(err => {\n                    times--;\n                    if (times <= 0) {\n                        reject(err);\n                    }\n                });\n            }\n        });\n    }\n    @property([cc.SpriteFrame])\n    icon_frames: Array<cc.SpriteFrame> = [];\n\n    @property(cc.Label)\n    lb_msg: cc.Label = null;\n\n    @property(cc.Sprite)\n    img_icon: cc.Sprite = null;\n\n    @property(cc.Label)\n    lb_num: cc.Label = null;\n\n    public startTime: number = 0;\n    public timer;\n    public duration: number = 2;\n\n    public iconIndex: number = 0;\n\n    public _show(msg: string, iconIndex: number, num: string, duration: number = 2) {\n        this.iconIndex = iconIndex;\n        this.startTime = (new Date()).getTime();\n        if (iconIndex < 0) {\n            this.img_icon.node.active = false;\n            this.node.width = 354;\n        } else {\n            this.img_icon.node.active = true;\n            this.img_icon.spriteFrame = this.icon_frames[iconIndex];\n            this.node.width = 400;\n        }\n        if (!num) {\n            this.lb_num.node.active = false;\n            this.node.height = 84;\n        } else {\n            this.lb_num.node.active = true;\n            this.lb_num.string = num;\n            this.node.height = 154;\n        }\n        this.duration = duration;\n        this.lb_msg.string = msg;\n        this.node.y = -50;\n        this.node.opacity = 0;\n\n    }\n\n    onLoad() {\n        cc.tween(this.node).to(0.3, { y: 0, opacity: 255 }, { easing: cc.easing.sineOut }).start();\n\n        this.timer = setTimeout(() => {\n            cc.tween(this.node)\n                .to(0.3, { y: this.node.y + 50, opacity: 0 }, { easing: cc.easing.sineOut })\n                .call(() => {\n                    this.node.removeFromParent();\n                    this.node.destroy();\n                })\n                .start();\n        }, this.duration * 1000);\n    }\n    onDestroy() {\n        clearTimeout(this.timer);\n    }\n}\n"]}